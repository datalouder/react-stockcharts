{"version":3,"sources":["../../../src/lib/calculator/pointAndFigure.js"],"names":["options","defaultOptions","dateAccessor","d","date","dateMutator","calculator","rawData","reversal","boxSize","sourcePath","source","high","low","close","pricingMethod","columnData","column","boxes","open","box","createBox","push","forEach","volume","startOfYear","startOfQuarter","startOfMonth","startOfWeek","length","upwardMovement","Math","max","downwardMovement","abs","min","direction","toDate","noOfBoxes","floor","i","prevBoxClose","fromDate","updateColumns","x","arguments","eachBox"],"mappings":"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","file":"pointAndFigure.js","sourcesContent":["import { isNotDefined } from '../utils';\nimport { PointAndFigure as defaultOptions } from './defaultOptionsForComputation';\n\nfunction createBox(d, dateAccessor, dateMutator) {\n  const box = {\n    open: d.open,\n    fromDate: dateAccessor(d),\n    toDate: dateAccessor(d),\n    startOfYear: d.startOfYear,\n    startOfQuarter: d.startOfQuarter,\n    startOfMonth: d.startOfMonth,\n    startOfWeek: d.startOfWeek,\n  };\n  dateMutator(box, dateAccessor(d));\n  return box;\n}\n\nfunction updateColumns(columnData, dateAccessor, dateMutator) {\n  columnData.forEach(function (d) {\n    // var lastBox = d.boxes[d.boxes.length - 1];\n\n    d.startOfYear = false;\n    d.startOfQuarter = false;\n    d.startOfMonth = false;\n    d.startOfWeek = false;\n\n    d.boxes.forEach(function (eachBox) {\n      if (isNotDefined(d.open)) d.open = eachBox.open;\n      d.close = eachBox.close;\n      d.high = Math.max(d.open, d.close);\n      d.low = Math.min(d.open, d.close);\n\n      if (isNotDefined(d.fromDate)) d.fromDate = eachBox.fromDate;\n      if (isNotDefined(d.date)) d.date = eachBox.date;\n      d.toDate = eachBox.toDate;\n\n      if (eachBox.startOfYear) {\n        d.startOfYear = d.startOfYear || eachBox.startOfYear;\n        d.startOfQuarter = eachBox.startOfQuarter;\n        d.startOfMonth = eachBox.startOfMonth;\n        d.startOfWeek = eachBox.startOfWeek;\n\n        dateMutator(d, dateAccessor(eachBox));\n      }\n      if (d.startOfQuarter !== true && eachBox.startOfQuarter) {\n        d.startOfQuarter = eachBox.startOfQuarter;\n        d.startOfMonth = eachBox.startOfMonth;\n        d.startOfWeek = eachBox.startOfWeek;\n        // d.displayDate = eachBox.displayDate;\n        dateMutator(d, dateAccessor(eachBox));\n      }\n      if (d.startOfMonth !== true && eachBox.startOfMonth) {\n        d.startOfMonth = eachBox.startOfMonth;\n        d.startOfWeek = eachBox.startOfWeek;\n        // d.displayDate = eachBox.displayDate;\n        dateMutator(d, dateAccessor(eachBox));\n      }\n      if (d.startOfWeek !== true && eachBox.startOfWeek) {\n        d.startOfWeek = eachBox.startOfWeek;\n        // d.displayDate = eachBox.displayDate;\n        dateMutator(d, dateAccessor(eachBox));\n      }\n    });\n  });\n\n  // console.table(columnData);\n  // console.table(rawData);\n  return columnData;\n}\n\nexport default function () {\n  let options = defaultOptions;\n  let dateAccessor = d => d.date;\n  let dateMutator = (d, date) => {\n    d.date = date;\n  };\n\n  function calculator(rawData) {\n    const { reversal, boxSize, sourcePath } = options;\n\n    const source =\n      sourcePath === 'high/low'\n        ? d => {\n            return { high: d.high, low: d.low };\n          }\n        : d => {\n            return { high: d.close, low: d.close };\n          };\n\n    const pricingMethod = source;\n    const columnData = [];\n\n    let column = {\n        boxes: [],\n        open: rawData[0].open,\n      },\n      box = createBox(rawData[0], dateAccessor, dateMutator);\n\n    columnData.push(column);\n\n    rawData.forEach(function (d) {\n      column.volume = (column.volume || 0) + d.volume;\n\n      if (!box.startOfYear) {\n        box.startOfYear = d.startOfYear;\n        if (box.startOfYear) {\n          dateMutator(box, dateAccessor(d));\n          // box.displayDate = d.displayDate;\n        }\n      }\n\n      if (!box.startOfYear && !box.startOfQuarter) {\n        box.startOfQuarter = d.startOfQuarter;\n        if (box.startOfQuarter && !box.startOfYear) {\n          dateMutator(box, dateAccessor(d));\n          // box.displayDate = d.displayDate;\n        }\n      }\n\n      if (!box.startOfQuarter && !box.startOfMonth) {\n        box.startOfMonth = d.startOfMonth;\n        if (box.startOfMonth && !box.startOfQuarter) {\n          dateMutator(box, dateAccessor(d));\n          // box.displayDate = d.displayDate;\n        }\n      }\n      if (!box.startOfMonth && !box.startOfWeek) {\n        box.startOfWeek = d.startOfWeek;\n        if (box.startOfWeek && !box.startOfMonth) {\n          dateMutator(box, dateAccessor(d));\n          // box.displayDate = d.displayDate;\n        }\n      }\n\n      if (columnData.length === 1 && column.boxes.length === 0) {\n        const upwardMovement = Math.max(pricingMethod(d).high - column.open, 0); // upward movement\n        const downwardMovement = Math.abs(\n          Math.min(column.open - pricingMethod(d).low, 0)\n        ); // downward movement\n        column.direction = upwardMovement > downwardMovement ? 1 : -1;\n        if (\n          boxSize * reversal < upwardMovement ||\n          boxSize * reversal < downwardMovement\n        ) {\n          // enough movement to trigger a reversal\n          box.toDate = dateAccessor(d);\n          box.open = column.open;\n          const noOfBoxes =\n            column.direction > 0\n              ? Math.floor(upwardMovement / boxSize)\n              : Math.floor(downwardMovement / boxSize);\n          for (let i = 0; i < noOfBoxes; i++) {\n            box.close = box.open + column.direction * boxSize;\n            const prevBoxClose = box.close;\n            column.boxes.push(box);\n            box = createBox(box, dateAccessor, dateMutator);\n            // box = cloneMe(box);\n            box.open = prevBoxClose;\n          }\n          box.fromDate = dateAccessor(d);\n          box.date = dateAccessor(d);\n        }\n      } else {\n        // one or more boxes already formed in the current column\n        const upwardMovement = Math.max(pricingMethod(d).high - box.open, 0); // upward movement\n        const downwardMovement = Math.abs(\n          Math.min(pricingMethod(d).low - box.open, 0)\n        ); // downward movement\n\n        if (\n          (column.direction > 0 &&\n            upwardMovement >\n              boxSize) /* rising column AND box can be formed */ ||\n          (column.direction < 0 &&\n            downwardMovement >\n              boxSize) /* falling column AND box can be formed */\n        ) {\n          // form another box\n          box.close = box.open + column.direction * boxSize;\n          box.toDate = dateAccessor(d);\n          const prevBoxClose = box.close;\n          column.boxes.push(box);\n          box = createBox(d, dateAccessor, dateMutator);\n          box.open = prevBoxClose;\n          box.fromDate = dateAccessor(d);\n          dateMutator(box, dateAccessor(d));\n        } else if (\n          (column.direction > 0 &&\n            downwardMovement >\n              boxSize *\n                reversal) /* rising column and there is downward movement to trigger a reversal */ ||\n          (column.direction < 0 &&\n            upwardMovement >\n              boxSize *\n                reversal) /* falling column and there is downward movement to trigger a reversal */\n        ) {\n          // reversal\n\n          box.open = box.open + -1 * column.direction * boxSize;\n          box.toDate = dateAccessor(d);\n          // box.displayDate = d.displayDate;\n          dateMutator(box, dateAccessor(d));\n          // box.startOfYear = d.startOfYear;\n          // box.startOfQuarter = d.startOfQuarter;\n          // box.startOfMonth = d.startOfMonth;\n          // box.startOfWeek = d.startOfWeek;\n          // console.table(column.boxes);\n          // var idx = index + 1;\n          column = {\n            boxes: [],\n            volume: 0,\n            direction: -1 * column.direction,\n          };\n          const noOfBoxes =\n            column.direction > 0\n              ? Math.floor(upwardMovement / boxSize)\n              : Math.floor(downwardMovement / boxSize);\n          for (let i = 0; i < noOfBoxes; i++) {\n            box.close = box.open + column.direction * boxSize;\n            const prevBoxClose = box.close;\n            column.boxes.push(box);\n            box = createBox(d, dateAccessor, dateMutator);\n            box.open = prevBoxClose;\n          }\n\n          columnData.push(column);\n        }\n      }\n    });\n    updateColumns(columnData, dateAccessor, dateMutator);\n\n    return columnData;\n  }\n  calculator.options = function (x) {\n    if (!arguments.length) {\n      return options;\n    }\n    options = { ...defaultOptions, ...x };\n    return calculator;\n  };\n  calculator.dateMutator = function (x) {\n    if (!arguments.length) return dateMutator;\n    dateMutator = x;\n    return calculator;\n  };\n  calculator.dateAccessor = function (x) {\n    if (!arguments.length) return dateAccessor;\n    dateAccessor = x;\n    return calculator;\n  };\n\n  return calculator;\n}\n"]}