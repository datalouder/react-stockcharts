{"version":3,"sources":["../../../src/lib/calculator/compare.js"],"names":["options","defaultOptions","calculator","data","basePath","mainKeys","compareKeys","base","first","b","firsts","compareData","map","result","forEach","d","key","Object","keys","subkey","x","arguments","length"],"mappings":";;;;;;;;;;kBAGe,YAAY;AACzB,MAAIA,UAAUC,oCAAd;;AAEA,WAASC,UAAT,CAAoBC,IAApB,EAA0B;AAAA,mBACoBH,OADpB;AAAA,QAChBI,QADgB,YAChBA,QADgB;AAAA,QACNC,QADM,YACNA,QADM;AAAA,QACIC,WADJ,YACIA,WADJ;;AAExB,QAAMC,OAAO,iBAAKH,QAAL,CAAb;;AAEA,QAAMI,QAAQ,iBAAKL,IAAL,CAAd;AACA,QAAMM,IAAIF,KAAKC,KAAL,CAAV;;AAEA;AACA,QAAIE,SAAS,EAAb;;AAEA,QAAMC,cAAcR,KAAKS,GAAL,CAAS,aAAK;AAChC;AACA,UAAIC,SAAS,EAAb;;AAEAR,eAASS,OAAT,CAAiB,eAAO;AACtB,YAAI,QAAOC,EAAEC,GAAF,CAAP,MAAkB,QAAtB,EAAgC;AAC9BH,iBAAOG,GAAP,IAAc,EAAd;AACAC,iBAAOC,IAAP,CAAYH,EAAEC,GAAF,CAAZ,EAAoBF,OAApB,CAA4B,kBAAU;AACpCD,mBAAOG,GAAP,EAAYG,MAAZ,IAAsB,CAACJ,EAAEC,GAAF,EAAOG,MAAP,IAAiBV,CAAlB,IAAuBA,CAA7C;AACD,WAFD;AAGD,SALD,MAKO;AACLI,iBAAOG,GAAP,IAAc,CAACD,EAAEC,GAAF,IAASP,CAAV,IAAeA,CAA7B;AACD;AACF,OATD;;AAWAH,kBAAYQ,OAAZ,CAAoB,eAAO;AACzB,YAAI,sBAAUC,EAAEC,GAAF,CAAV,KAAqB,yBAAaN,OAAOM,GAAP,CAAb,CAAzB,EAAoD;AAClDN,iBAAOM,GAAP,IAAcD,EAAEC,GAAF,CAAd;AACD;AACD,YAAI,sBAAUD,EAAEC,GAAF,CAAV,KAAqB,sBAAUN,OAAOM,GAAP,CAAV,CAAzB,EAAiD;AAC/CH,iBAAOG,GAAP,IAAc,CAACD,EAAEC,GAAF,IAASN,OAAOM,GAAP,CAAV,IAAyBN,OAAOM,GAAP,CAAvC;AACD;AACF,OAPD;AAQA,aAAOH,MAAP;AACD,KAxBmB,CAApB;AAyBA;AACA,WAAOF,WAAP;AACD;AACDT,aAAWF,OAAX,GAAqB,UAAUoB,CAAV,EAAa;AAChC,QAAI,CAACC,UAAUC,MAAf,EAAuB;AACrB,aAAOtB,OAAP;AACD;AACDA,2BAAeC,oCAAf,EAAkCmB,CAAlC;AACA,WAAOlB,UAAP;AACD,GAND;AAOA,SAAOA,UAAP;AACD,C;;AApDD;;AACA","file":"compare.js","sourcesContent":["import { head, path, isDefined, isNotDefined } from '../utils';\nimport { Change as defaultOptions } from './defaultOptionsForComputation';\n\nexport default function () {\n  let options = defaultOptions;\n\n  function calculator(data) {\n    const { basePath, mainKeys, compareKeys } = options;\n    const base = path(basePath);\n\n    const first = head(data);\n    const b = base(first);\n\n    // eslint-disable-next-line prefer-const\n    let firsts = {};\n\n    const compareData = data.map(d => {\n      // eslint-disable-next-line prefer-const\n      let result = {};\n\n      mainKeys.forEach(key => {\n        if (typeof d[key] === 'object') {\n          result[key] = {};\n          Object.keys(d[key]).forEach(subkey => {\n            result[key][subkey] = (d[key][subkey] - b) / b;\n          });\n        } else {\n          result[key] = (d[key] - b) / b;\n        }\n      });\n\n      compareKeys.forEach(key => {\n        if (isDefined(d[key]) && isNotDefined(firsts[key])) {\n          firsts[key] = d[key];\n        }\n        if (isDefined(d[key]) && isDefined(firsts[key])) {\n          result[key] = (d[key] - firsts[key]) / firsts[key];\n        }\n      });\n      return result;\n    });\n    // console.log(compareData[20]);\n    return compareData;\n  }\n  calculator.options = function (x) {\n    if (!arguments.length) {\n      return options;\n    }\n    options = { ...defaultOptions, ...x };\n    return calculator;\n  };\n  return calculator;\n}\n"]}