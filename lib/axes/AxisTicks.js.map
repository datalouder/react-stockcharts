{"version":3,"sources":["../../../src/lib/axes/AxisTicks.js"],"names":["tickTransform_svg_axisX","scale","tick","Math","round","tickTransform_svg_axisY","Tick","props","transform","tickStroke","tickStrokeOpacity","textAnchor","fontSize","fontFamily","x","y","x2","y2","dy","children","Component","propTypes","PropTypes","arrayOf","Number","string","number","node","isRequired","drawOnCanvasStatic","ctx","result","tickTransform","canvas_dy","format","origin","beginPath","moveTo","lineTo","stroke","fillText","AxisTicks","helper","ticks","map","idx","orient","oneOf","innerTickSize","tickFormat","func","tickPadding","array","tickValues","defaultProps","tickArguments","domain","baseFormat","identity","d","sign","tickSpacing","max","xScale","yScale","xAxis","strokeStyle","font","fillStyle","textAlign","forEach"],"mappings":"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","file":"AxisTicks.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { hexToRGBA, isNotDefined, identity } from '../utils';\n\nfunction tickTransform_svg_axisX(scale, tick) {\n  return [Math.round(scale(tick)), 0];\n}\n\nfunction tickTransform_svg_axisY(scale, tick) {\n  return [0, Math.round(scale(tick))];\n}\n\nclass Tick extends Component {\n  render() {\n    const {\n      transform,\n      tickStroke,\n      tickStrokeOpacity,\n      textAnchor,\n      fontSize,\n      fontFamily,\n    } = this.props;\n    const { x, y, x2, y2, dy } = this.props;\n    return (\n      <g\n        className=\"tick\"\n        transform={`translate(${transform[0]}, ${transform[1]})`}\n      >\n        <line\n          shapeRendering=\"crispEdges\"\n          opacity={tickStrokeOpacity}\n          stroke={tickStroke}\n          x2={x2}\n          y2={y2}\n        />\n        <text\n          dy={dy}\n          x={x}\n          y={y}\n          fill={tickStroke}\n          fontSize={fontSize}\n          fontFamily={fontFamily}\n          textAnchor={textAnchor}\n        >\n          {this.props.children}\n        </text>\n      </g>\n    );\n  }\n}\n\nTick.propTypes = {\n  transform: PropTypes.arrayOf(Number),\n  tickStroke: PropTypes.string,\n  tickStrokeOpacity: PropTypes.number,\n  textAnchor: PropTypes.string,\n  fontSize: PropTypes.number,\n  fontFamily: PropTypes.string,\n  x: PropTypes.number,\n  y: PropTypes.number,\n  x2: PropTypes.number,\n  y2: PropTypes.number,\n  dy: PropTypes.string,\n  children: PropTypes.node.isRequired,\n};\n\nTick.drawOnCanvasStatic = (tick, ctx, result) => {\n  const { scale, tickTransform, canvas_dy, x, y, x2, y2, format } = result;\n\n  const origin = tickTransform(scale, tick);\n\n  ctx.beginPath();\n\n  ctx.moveTo(origin[0], origin[1]);\n  ctx.lineTo(origin[0] + x2, origin[1] + y2);\n  ctx.stroke();\n\n  ctx.fillText(format(tick), origin[0] + x, origin[1] + y + canvas_dy);\n};\n\nclass AxisTicks extends Component {\n  render() {\n    const result = AxisTicks.helper(this.props, this.props.scale);\n    const {\n      ticks,\n      scale,\n      tickTransform,\n      tickStroke,\n      tickStrokeOpacity,\n      dy,\n      x,\n      y,\n      x2,\n      y2,\n      textAnchor,\n      fontSize,\n      fontFamily,\n      format,\n    } = result;\n\n    return (\n      <g>\n        {ticks.map((tick, idx) => {\n          return (\n            <Tick\n              key={idx}\n              transform={tickTransform(scale, tick)}\n              tickStroke={tickStroke}\n              tickStrokeOpacity={tickStrokeOpacity}\n              dy={dy}\n              x={x}\n              y={y}\n              x2={x2}\n              y2={y2}\n              textAnchor={textAnchor}\n              fontSize={fontSize}\n              fontFamily={fontFamily}\n            >\n              {format(tick)}\n            </Tick>\n          );\n        })}\n      </g>\n    );\n  }\n}\n\nAxisTicks.propTypes = {\n  orient: PropTypes.oneOf(['top', 'bottom', 'left', 'right']).isRequired,\n  innerTickSize: PropTypes.number,\n  tickFormat: PropTypes.func,\n  tickPadding: PropTypes.number,\n  ticks: PropTypes.array,\n  tickValues: PropTypes.array,\n  scale: PropTypes.func.isRequired,\n  tickStroke: PropTypes.string,\n  tickStrokeOpacity: PropTypes.number,\n};\n\nAxisTicks.defaultProps = {\n  innerTickSize: 5,\n  tickPadding: 6,\n  ticks: [10],\n  tickStroke: '#000',\n  tickStrokeOpacity: 1,\n};\n\nAxisTicks.helper = (props, scale) => {\n  const {\n    orient,\n    innerTickSize,\n    tickFormat,\n    tickPadding,\n    fontSize,\n    fontFamily,\n  } = props;\n  const {\n    ticks: tickArguments,\n    tickValues,\n    tickStroke,\n    tickStrokeOpacity,\n  } = props;\n\n  const ticks = isNotDefined(tickValues)\n    ? scale.ticks\n      ? scale.ticks(...tickArguments)\n      : scale.domain()\n    : tickValues;\n\n  const baseFormat = scale.tickFormat\n    ? scale.tickFormat(...tickArguments)\n    : identity;\n\n  const format = isNotDefined(tickFormat)\n    ? baseFormat\n    : d => (baseFormat(d) ? tickFormat(d) : '');\n\n  const sign = orient === 'top' || orient === 'left' ? -1 : 1;\n  const tickSpacing = Math.max(innerTickSize, 0) + tickPadding;\n\n  let tickTransform, x, y, x2, y2, dy, canvas_dy, textAnchor;\n\n  if (orient === 'bottom' || orient === 'top') {\n    tickTransform = tickTransform_svg_axisX;\n    x2 = 0;\n    y2 = sign * innerTickSize;\n    x = 0;\n    y = sign * tickSpacing;\n    dy = sign < 0 ? '0em' : '.71em';\n    canvas_dy = sign < 0 ? 0 : fontSize * 0.71;\n    textAnchor = 'middle';\n  } else {\n    tickTransform = tickTransform_svg_axisY;\n    x2 = sign * innerTickSize;\n    y2 = 0;\n    x = sign * tickSpacing;\n    y = 0;\n    dy = '.32em';\n    canvas_dy = fontSize * 0.32;\n    textAnchor = sign < 0 ? 'end' : 'start';\n  }\n  return {\n    ticks,\n    scale,\n    tickTransform,\n    tickStroke,\n    tickStrokeOpacity,\n    dy,\n    canvas_dy,\n    x,\n    y,\n    x2,\n    y2,\n    textAnchor,\n    fontSize,\n    fontFamily,\n    format,\n  };\n};\n\nAxisTicks.drawOnCanvasStatic = (props, ctx, xScale, yScale) => {\n  props = { ...AxisTicks.defaultProps, ...props };\n\n  const { orient } = props;\n  const xAxis = orient === 'bottom' || orient === 'top';\n\n  const result = AxisTicks.helper(props, xAxis ? xScale : yScale);\n\n  const { tickStroke, tickStrokeOpacity, textAnchor, fontSize, fontFamily } =\n    result;\n\n  ctx.strokeStyle = hexToRGBA(tickStroke, tickStrokeOpacity);\n\n  ctx.font = `${fontSize}px ${fontFamily}`;\n  ctx.fillStyle = tickStroke;\n  ctx.textAlign = textAnchor === 'middle' ? 'center' : textAnchor;\n  // ctx.textBaseline = 'middle';\n\n  result.ticks.forEach(tick => {\n    Tick.drawOnCanvasStatic(tick, ctx, result);\n  });\n};\n\nexport default AxisTicks;\n"]}