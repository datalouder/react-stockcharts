{"version":3,"sources":["../../../src/lib/coordinates/MouseCoordinateXV2.js"],"names":["propTypes","xPosition","PropTypes","func","drawCoordinate","displayFormat","isRequired","at","oneOf","orient","text","shape","fontStyle","string","fontWeight","fontFamily","fontSize","number","fill","oneOfType","bg","stroke","strokeWidth","padding","left","right","top","bottom","dx","dy","defaultProps","MouseCoordinateXV2","props","drawOnCanvas","bind","ctx","moreProps","show","currentItem","getXCoordinateInfo","getMouseCanvas","Component","xAccessor","xValue","xScale","height","chartConfig","font","t","textWidth","measureText","width","y","x","Math","round","textFill","textAlign","sign","halfWidth","strokeStyle","fillStyle","lineWidth","beginPath","moveTo","lineTo","closePath","textBaseline","pad","fillText"],"mappings":"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","file":"MouseCoordinateXV2.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport GenericChartComponent from '../GenericChartComponent';\nimport { getMouseCanvas } from '../GenericComponent';\n\nconst propTypes = {\n  xPosition: PropTypes.func,\n  drawCoordinate: PropTypes.func,\n  displayFormat: PropTypes.func.isRequired,\n  at: PropTypes.oneOf(['bottom', 'top']),\n  orient: PropTypes.oneOf(['bottom', 'top']),\n  text: PropTypes.shape({\n    fontStyle: PropTypes.string,\n    fontWeight: PropTypes.string,\n    fontFamily: PropTypes.string,\n    fontSize: PropTypes.number,\n    fill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\n  }),\n  bg: PropTypes.shape({\n    fill: PropTypes.oneOfType([PropTypes.func, PropTypes.string]),\n    stroke: PropTypes.string,\n    strokeWidth: PropTypes.number,\n    padding: PropTypes.shape({\n      left: PropTypes.number,\n      right: PropTypes.number,\n      top: PropTypes.number,\n      bottom: PropTypes.number,\n    }),\n  }),\n  dx: PropTypes.number,\n  dy: PropTypes.number,\n};\n\nconst defaultProps = {\n  xPosition,\n  drawCoordinate,\n  at: 'bottom',\n  orient: 'bottom',\n\n  text: {\n    fontStyle: '',\n    fontWeight: '',\n    fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n    fontSize: 13,\n    fill: 'rgb(35, 35, 35)',\n  },\n  bg: {\n    fill: 'rgb(255, 255, 255)',\n    stroke: 'rgb(35, 35, 35)',\n    strokeWidth: 1,\n    padding: {\n      left: 7,\n      right: 7,\n      top: 4,\n      bottom: 4,\n    },\n  },\n  dx: 7,\n  dy: 7,\n};\n\nclass MouseCoordinateXV2 extends Component {\n  constructor(props) {\n    super(props);\n    this.drawOnCanvas = this.drawOnCanvas.bind(this);\n  }\n  drawOnCanvas(ctx, moreProps) {\n    const { show, currentItem } = moreProps;\n    const { drawCoordinate } = this.props;\n\n    if (show && currentItem != null) {\n      const shape = getXCoordinateInfo(ctx, this.props, moreProps);\n      drawCoordinate(ctx, shape, this.props, moreProps);\n    }\n  }\n  render() {\n    return (\n      <GenericChartComponent\n        clip={false}\n        canvasDraw={this.drawOnCanvas}\n        canvasToDraw={getMouseCanvas}\n        drawOn={['mousemove', 'pan', 'drag']}\n      />\n    );\n  }\n}\n\nMouseCoordinateXV2.defaultProps = defaultProps;\nMouseCoordinateXV2.propTypes = propTypes;\n\nfunction xPosition(props, moreProps) {\n  const { currentItem, xAccessor } = moreProps;\n  return xAccessor(currentItem);\n}\nfunction getXCoordinateInfo(ctx, props, moreProps) {\n  const { xPosition } = props;\n  const xValue = xPosition(props, moreProps);\n  const { at, displayFormat } = props;\n  const { text } = props;\n  const {\n    xScale,\n    chartConfig: { height },\n  } = moreProps;\n  ctx.font = `${text.fontStyle} ${text.fontWeight} ${text.fontSize}px ${text.fontFamily}`;\n\n  const t = displayFormat(xValue);\n  const textWidth = ctx.measureText(t).width;\n\n  const y = at === 'bottom' ? height : 0;\n  const x = Math.round(xScale(xValue));\n\n  return {\n    x,\n    y,\n    textWidth,\n    text: t,\n  };\n}\n\nfunction drawCoordinate(ctx, shape, props, moreProps) {\n  const { x, y, textWidth, text } = shape;\n  const { orient, dx, dy } = props;\n\n  const {\n    bg: { padding, fill, stroke, strokeWidth },\n    text: { fontSize, fill: textFill },\n  } = props;\n\n  ctx.textAlign = 'center';\n\n  const sign = orient === 'top' ? -1 : 1;\n  const halfWidth = Math.round(textWidth / 2 + padding.right);\n  const height = Math.round(fontSize + padding.top + padding.bottom);\n\n  ctx.strokeStyle =\n    typeof stroke === 'function' ? stroke(moreProps, ctx) : stroke;\n  ctx.fillStyle = typeof fill === 'function' ? fill(moreProps, ctx) : fill;\n  ctx.lineWidth =\n    typeof strokeWidth === 'function' ? strokeWidth(moreProps) : strokeWidth;\n\n  ctx.beginPath();\n\n  ctx.moveTo(x, y);\n  ctx.lineTo(x + dx, y + sign * dy);\n  ctx.lineTo(x + halfWidth, y + sign * dy);\n  ctx.lineTo(x + halfWidth, y + sign * (dy + height));\n  ctx.lineTo(x - halfWidth, y + sign * (dy + height));\n  ctx.lineTo(x - halfWidth, y + sign * dy);\n  ctx.lineTo(x - dx, y + sign * dy);\n  ctx.closePath();\n  ctx.stroke();\n  ctx.fill();\n\n  ctx.beginPath();\n  ctx.fillStyle =\n    typeof textFill === 'function' ? textFill(moreProps, ctx) : textFill;\n\n  ctx.textBaseline = orient === 'top' ? 'alphabetic' : 'hanging';\n  const pad = orient === 'top' ? padding.bottom : padding.top;\n\n  ctx.fillText(text, x, y + sign * (dy + pad + 2));\n}\n\nexport default MouseCoordinateXV2;\n"]}