{"version":3,"sources":["../../../src/lib/coordinates/EdgeIndicator.js"],"names":["EdgeIndicator","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","edge","helper","getAxisCanvas","Component","propTypes","yAccessor","PropTypes","func","type","oneOf","className","string","fill","oneOfType","lineStroke","textFill","itemType","isRequired","orient","edgeAt","displayFormat","rectHeight","number","rectWidth","arrowWidth","lineStrokeDasharray","strokeDashTypes","defaultProps","yAxisPad","fontFamily","fontSize","dx","hideLine","opacity","stroke","noop","strokeOpacity","strokeWidth","lineOpacity","plotData","item","getEdge","edgeType","xScale","yScale","chartConfig","xAccessor","width","yValue","xValue","x1","Math","round","y1","left","right","edgeX","coordinate","show","x2","y2"],"mappings":"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","file":"EdgeIndicator.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { format } from 'd3-format';\n\nimport { drawOnCanvas, renderSVG } from './EdgeCoordinateV3';\nimport GenericChartComponent from '../GenericChartComponent';\nimport { getAxisCanvas } from '../GenericComponent';\n\nimport {\n  first,\n  last,\n  isDefined,\n  functor,\n  noop,\n  strokeDashTypes,\n} from '../utils';\n\nclass EdgeIndicator extends Component {\n  constructor(props) {\n    super(props);\n    this.renderSVG = this.renderSVG.bind(this);\n    this.drawOnCanvas = this.drawOnCanvas.bind(this);\n  }\n  drawOnCanvas(ctx, moreProps) {\n    const edge = helper(this.props, moreProps);\n    const props = {\n      ...this.props,\n      ...edge,\n    };\n    drawOnCanvas(ctx, props);\n  }\n  renderSVG(moreProps) {\n    const edge = helper(this.props, moreProps);\n    const props = {\n      ...this.props,\n      ...edge,\n    };\n    return renderSVG(props);\n  }\n  render() {\n    return (\n      <GenericChartComponent\n        edgeClip\n        clip={false}\n        svgDraw={this.renderSVG}\n        canvasDraw={this.drawOnCanvas}\n        canvasToDraw={getAxisCanvas}\n        drawOn={['pan']}\n      />\n    );\n  }\n}\n\nEdgeIndicator.propTypes = {\n  yAccessor: PropTypes.func,\n\n  type: PropTypes.oneOf(['horizontal']),\n  className: PropTypes.string,\n  fill: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n  lineStroke: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n  textFill: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n  itemType: PropTypes.oneOf(['first', 'last']).isRequired,\n  orient: PropTypes.oneOf(['left', 'right']),\n  edgeAt: PropTypes.oneOf(['left', 'right']),\n  displayFormat: PropTypes.func,\n  rectHeight: PropTypes.number,\n  rectWidth: PropTypes.number,\n  arrowWidth: PropTypes.number,\n  lineStrokeDasharray: PropTypes.oneOf(strokeDashTypes),\n};\n\nEdgeIndicator.defaultProps = {\n  className: 'react-stockcharts-edgeindicator',\n\n  type: 'horizontal',\n  orient: 'left',\n  edgeAt: 'left',\n  textFill: '#FFFFFF',\n  displayFormat: format('.2f'),\n  yAxisPad: 0,\n  rectHeight: 20,\n  rectWidth: 50,\n  arrowWidth: 10,\n  fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n  fontSize: 13,\n  dx: 0,\n  hideLine: false,\n  fill: '#8a8a8a',\n  opacity: 1,\n\n  stroke: noop,\n  strokeOpacity: 1,\n  strokeWidth: 3,\n  lineStroke: '#000000',\n  lineOpacity: 0.3,\n  lineStrokeDasharray: 'ShortDash',\n};\n\nfunction helper(props, moreProps) {\n  const { itemType, yAccessor } = props;\n  const { plotData } = moreProps;\n\n  const item =\n    itemType === 'first'\n      ? first(plotData, yAccessor)\n      : last(plotData, yAccessor);\n\n  // var currentItem = ChartDataUtil.getCurrentItemForChartNew(currentItems, forChart);\n  const edge = isDefined(item) ? getEdge(props, moreProps, item) : null;\n\n  return edge;\n}\n\nfunction getEdge(props, moreProps, item) {\n  const {\n    type: edgeType,\n    displayFormat,\n    edgeAt,\n    yAxisPad,\n    orient,\n    lineStroke,\n  } = props;\n\n  const { yAccessor, fill, textFill, rectHeight, rectWidth, arrowWidth } =\n    props;\n  const { fontFamily, fontSize } = props;\n  const { stroke } = props;\n\n  const {\n    xScale,\n    chartConfig: { yScale },\n    xAccessor,\n    width,\n  } = moreProps;\n\n  const yValue = yAccessor(item),\n    xValue = xAccessor(item);\n\n  const x1 = Math.round(xScale(xValue)),\n    y1 = Math.round(yScale(yValue));\n\n  const [left, right] = [0, width];\n  const edgeX = edgeAt === 'left' ? left - yAxisPad : right + yAxisPad;\n\n  return {\n    // ...props,\n    coordinate: displayFormat(yValue),\n    show: true,\n    type: edgeType,\n    orient,\n    edgeAt: edgeX,\n    fill: functor(fill)(item),\n    lineStroke: functor(lineStroke)(item),\n    stroke: functor(stroke)(item),\n    fontFamily,\n    fontSize,\n    textFill: functor(textFill)(item),\n    rectHeight,\n    rectWidth,\n    arrowWidth,\n    x1,\n    y1,\n    x2: right,\n    y2: y1,\n  };\n}\n\nexport default EdgeIndicator;\n"]}