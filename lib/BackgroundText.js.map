{"version":3,"sources":["../../src/lib/BackgroundText.js"],"names":["BackgroundText","context","chartCanvasType","getCanvasContexts","contexts","drawOnCanvas","bg","props","children","componentDidMount","x","y","fill","opacity","stroke","strokeOpacity","fontFamily","fontSize","textAnchor","PureComponent","ctx","getText","interval","clearRect","canvas","width","height","save","setTransform","translate","text","strokeStyle","font","fillStyle","textAlign","strokeText","fillText","restore","propTypes","PropTypes","number","isRequired","string","func","defaultProps","contextTypes"],"mappings":"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","file":"BackgroundText.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport PureComponent from './utils/PureComponent';\n\nimport { hexToRGBA, isDefined } from './utils';\n\nclass BackgroundText extends PureComponent {\n  componentDidMount() {\n    if (\n      this.context.chartCanvasType !== 'svg' &&\n      isDefined(this.context.getCanvasContexts)\n    ) {\n      const contexts = this.context.getCanvasContexts();\n      if (contexts)\n        BackgroundText.drawOnCanvas(\n          contexts.bg,\n          this.props,\n          this.context,\n          this.props.children\n        );\n    }\n  }\n  componentDidUpdate() {\n    this.componentDidMount();\n  }\n  render() {\n    const { chartCanvasType } = this.context;\n\n    if (chartCanvasType !== 'svg') return null;\n\n    const {\n      x,\n      y,\n      fill,\n      opacity,\n      stroke,\n      strokeOpacity,\n      fontFamily,\n      fontSize,\n      textAnchor,\n    } = this.props;\n    const props = {\n      x,\n      y,\n      fill,\n      opacity,\n      stroke,\n      strokeOpacity,\n      fontFamily,\n      fontSize,\n      textAnchor,\n    };\n    return <text {...props}>this.props.children(interval)</text>;\n  }\n}\n\nBackgroundText.drawOnCanvas = (ctx, props, { interval }, getText) => {\n  ctx.clearRect(-1, -1, ctx.canvas.width + 2, ctx.canvas.height + 2);\n  ctx.save();\n\n  ctx.setTransform(1, 0, 0, 1, 0, 0);\n  ctx.translate(0.5, 0.5);\n\n  const {\n    x,\n    y,\n    fill,\n    opacity,\n    stroke,\n    strokeOpacity,\n    fontFamily,\n    fontSize,\n    textAnchor,\n  } = props;\n\n  const text = getText(interval);\n\n  ctx.strokeStyle = hexToRGBA(stroke, strokeOpacity);\n\n  ctx.font = `${fontSize}px ${fontFamily}`;\n  ctx.fillStyle = hexToRGBA(fill, opacity);\n  ctx.textAlign = textAnchor === 'middle' ? 'center' : textAnchor;\n\n  if (stroke !== 'none') ctx.strokeText(text, x, y);\n  ctx.fillText(text, x, y);\n\n  ctx.restore();\n};\n\nBackgroundText.propTypes = {\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  fontFamily: PropTypes.string,\n  fontSize: PropTypes.number.isRequired,\n  fill: PropTypes.string,\n  stroke: PropTypes.string,\n  opacity: PropTypes.number,\n  strokeOpacity: PropTypes.number,\n  textAnchor: PropTypes.string,\n  children: PropTypes.func,\n};\n\nBackgroundText.defaultProps = {\n  opacity: 0.3,\n  fill: '#9E7523',\n  stroke: '#9E7523',\n  strokeOpacity: 1,\n  fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n  fontSize: 12,\n  textAnchor: 'middle',\n};\n\nBackgroundText.contextTypes = {\n  interval: PropTypes.string.isRequired,\n  getCanvasContexts: PropTypes.func,\n  chartCanvasType: PropTypes.string,\n};\n\nexport default BackgroundText;\n"]}