{"version":3,"sources":["../../../src/lib/interactive/StandardDeviationChannel.js"],"names":["StandardDeviationChannel","props","handleStart","bind","handleEnd","handleDrawLine","handleDragLine","handleDragLineComplete","terminate","saveNodeType","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","channels","newChannels","map","each","idx","start","x1Value","y1Value","end","x2Value","y2Value","selected","onComplete","xyValue","current","mouseMoved","onStart","e","appearance","d","enabled","snapTo","currentPositionRadius","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","hoverText","eachDefaultAppearance","defaultProps","hoverTextDefault","tempLine","eachAppearance","eachHoverText","Component","propTypes","PropTypes","bool","isRequired","func","onSelect","string","number","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStrokeWidth","edgeStroke","edgeFill","r","object","array","close","noop","HoverTextNearMouse","enable","bgHeight","bgWidth","text","selectedText"],"mappings":"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","file":"StandardDeviationChannel.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { isDefined, isNotDefined, noop } from '../utils';\n\nimport {\n  getValueFromOverride,\n  terminate,\n  saveNodeType,\n  isHoverForInteractiveType,\n} from './utils';\n\nimport EachLinearRegressionChannel from './wrapper/EachLinearRegressionChannel';\nimport MouseLocationIndicator from './components/MouseLocationIndicator';\nimport HoverTextNearMouse from './components/HoverTextNearMouse';\n\nclass StandardDeviationChannel extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleStart = this.handleStart.bind(this);\n    this.handleEnd = this.handleEnd.bind(this);\n    this.handleDrawLine = this.handleDrawLine.bind(this);\n    this.handleDragLine = this.handleDragLine.bind(this);\n    this.handleDragLineComplete = this.handleDragLineComplete.bind(this);\n\n    this.terminate = terminate.bind(this);\n    this.saveNodeType = saveNodeType.bind(this);\n\n    this.getSelectionState = isHoverForInteractiveType('channels').bind(this);\n\n    this.nodes = [];\n    this.state = {};\n  }\n  handleDragLine(index, newXYValue) {\n    this.setState({\n      override: {\n        index,\n        ...newXYValue,\n      },\n    });\n  }\n  handleDragLineComplete(moreProps) {\n    const { override } = this.state;\n    const { channels } = this.props;\n    if (isDefined(override)) {\n      const newChannels = channels.map((each, idx) =>\n        idx === override.index\n          ? {\n              ...each,\n              start: [override.x1Value, override.y1Value],\n              end: [override.x2Value, override.y2Value],\n              selected: true,\n            }\n          : each\n      );\n      this.setState(\n        {\n          override: null,\n        },\n        () => {\n          this.props.onComplete(newChannels, moreProps);\n        }\n      );\n    }\n  }\n  handleDrawLine(xyValue) {\n    const { current } = this.state;\n\n    if (isDefined(current) && isDefined(current.start)) {\n      this.mouseMoved = true;\n      this.setState({\n        current: {\n          start: current.start,\n          end: xyValue,\n        },\n      });\n    }\n  }\n  handleStart(xyValue) {\n    const { current } = this.state;\n\n    if (isNotDefined(current) || isNotDefined(current.start)) {\n      this.mouseMoved = false;\n\n      this.setState(\n        {\n          current: {\n            start: xyValue,\n            end: null,\n          },\n        },\n        () => {\n          this.props.onStart();\n        }\n      );\n    }\n  }\n  handleEnd(xyValue, moreProps, e) {\n    const { current } = this.state;\n    const { appearance, channels } = this.props;\n\n    if (this.mouseMoved && isDefined(current) && isDefined(current.start)) {\n      const newChannels = [\n        ...channels.map(d => ({ ...d, selected: false })),\n        {\n          start: current.start,\n          end: xyValue,\n          selected: true,\n          appearance,\n        },\n      ];\n\n      this.setState(\n        {\n          current: null,\n        },\n        () => {\n          this.props.onComplete(newChannels, moreProps, e);\n        }\n      );\n    }\n  }\n  render() {\n    const { appearance } = this.props;\n    const { enabled, snapTo } = this.props;\n    const { currentPositionRadius, currentPositionStroke } = this.props;\n    const { currentPositionOpacity, currentPositionStrokeWidth } = this.props;\n    const { hoverText, channels } = this.props;\n    const { current, override } = this.state;\n\n    const eachDefaultAppearance = {\n      ...StandardDeviationChannel.defaultProps.appearance,\n      ...appearance,\n    };\n\n    const hoverTextDefault = {\n      ...StandardDeviationChannel.defaultProps.hoverText,\n      ...hoverText,\n    };\n\n    const tempLine =\n      isDefined(current) && isDefined(current.end) ? (\n        <EachLinearRegressionChannel\n          interactive={false}\n          x1Value={current.start[0]}\n          x2Value={current.end[0]}\n          appearance={eachDefaultAppearance}\n          hoverText={hoverTextDefault}\n        />\n      ) : null;\n\n    return (\n      <g>\n        {channels.map((each, idx) => {\n          const eachAppearance = isDefined(each.appearance)\n            ? { ...eachDefaultAppearance, ...each.appearance }\n            : eachDefaultAppearance;\n\n          const eachHoverText = isDefined(each.hoverText)\n            ? { ...hoverTextDefault, ...each.hoverText }\n            : hoverTextDefault;\n\n          return (\n            <EachLinearRegressionChannel\n              key={idx}\n              ref={this.saveNodeType(idx)}\n              index={idx}\n              selected={each.selected}\n              x1Value={getValueFromOverride(\n                override,\n                idx,\n                'x1Value',\n                each.start[0]\n              )}\n              x2Value={getValueFromOverride(\n                override,\n                idx,\n                'x2Value',\n                each.end[0]\n              )}\n              appearance={eachAppearance}\n              snapTo={snapTo}\n              hoverText={eachHoverText}\n              onDrag={this.handleDragLine}\n              onDragComplete={this.handleDragLineComplete}\n              edgeInteractiveCursor=\"react-stockcharts-move-cursor\"\n            />\n          );\n        })}\n        {tempLine}\n        <MouseLocationIndicator\n          enabled={enabled}\n          snap\n          snapTo={snapTo}\n          r={currentPositionRadius}\n          stroke={currentPositionStroke}\n          opacity={currentPositionOpacity}\n          strokeWidth={currentPositionStrokeWidth}\n          onMouseDown={this.handleStart}\n          onClick={this.handleEnd}\n          onMouseMove={this.handleDrawLine}\n        />\n      </g>\n    );\n  }\n}\n\nStandardDeviationChannel.propTypes = {\n  enabled: PropTypes.bool.isRequired,\n  snapTo: PropTypes.func,\n\n  onStart: PropTypes.func,\n  onComplete: PropTypes.func.isRequired,\n  onSelect: PropTypes.func,\n\n  currentPositionStroke: PropTypes.string,\n  currentPositionStrokeWidth: PropTypes.number,\n  currentPositionOpacity: PropTypes.number,\n  currentPositionRadius: PropTypes.number,\n\n  appearance: PropTypes.shape({\n    stroke: PropTypes.string,\n    strokeOpacity: PropTypes.number,\n    strokeWidth: PropTypes.number,\n    fill: PropTypes.string,\n    fillOpacity: PropTypes.number,\n    edgeStrokeWidth: PropTypes.number,\n    edgeStroke: PropTypes.string,\n    edgeFill: PropTypes.string,\n    r: PropTypes.number,\n  }).isRequired,\n\n  hoverText: PropTypes.object,\n  channels: PropTypes.array.isRequired,\n};\n\nStandardDeviationChannel.defaultProps = {\n  snapTo: d => d.close,\n  appearance: {\n    stroke: '#000000',\n    fillOpacity: 0.2,\n    strokeOpacity: 1,\n    strokeWidth: 1,\n    fill: '#8AAFE2',\n    edgeStrokeWidth: 2,\n    edgeStroke: '#000000',\n    edgeFill: '#FFFFFF',\n    r: 5,\n  },\n\n  onStart: noop,\n  onComplete: noop,\n  onSelect: noop,\n\n  currentPositionStroke: '#000000',\n  currentPositionOpacity: 1,\n  currentPositionStrokeWidth: 3,\n  currentPositionRadius: 4,\n\n  hoverText: {\n    ...HoverTextNearMouse.defaultProps,\n    enable: true,\n    bgHeight: 'auto',\n    bgWidth: 'auto',\n    text: 'Click and drag the edge circles',\n    selectedText: '',\n  },\n  channels: [],\n};\n\nexport default StandardDeviationChannel;\n"]}