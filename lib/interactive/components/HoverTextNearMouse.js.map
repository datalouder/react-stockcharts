{"version":3,"sources":["../../../../src/lib/interactive/components/HoverTextNearMouse.js"],"names":["PADDING","MIN_WIDTH","HoverTextNearMouse","props","state","textWidth","undefined","textHeight","saveNode","bind","updateTextSize","renderSVG","node","textNode","bgWidth","bgHeight","getBBox","width","height","setState","moreProps","fontFamily","fontSize","fill","bgFill","bgOpacity","textMetaData","helper","getBgWidth","getBgHeight","rect","text","x","y","Component","numberOrString","PropTypes","oneOfType","number","oneOf","propTypes","string","isRequired","show","bool","defaultProps","mouseXY","chartConfig","mouseInsideCanvas","cx","cy"],"mappings":"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","file":"HoverTextNearMouse.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport GenericChartComponent from '../../GenericChartComponent';\nimport { isDefined } from '../../utils';\n\nconst PADDING = 10;\nconst MIN_WIDTH = PADDING;\n\nclass HoverTextNearMouse extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      textWidth: undefined,\n      textHeight: undefined,\n    };\n\n    this.saveNode = this.saveNode.bind(this);\n    this.updateTextSize = this.updateTextSize.bind(this);\n    this.renderSVG = this.renderSVG.bind(this);\n  }\n  saveNode(node) {\n    this.textNode = node;\n  }\n\n  updateTextSize() {\n    const { bgWidth, bgHeight } = this.props;\n    if (bgWidth === 'auto' || bgHeight === 'auto') {\n      const textNode = this.textNode;\n      if (textNode) {\n        const { width, height } = textNode.getBBox();\n        if (\n          this.state.textWidth !== width ||\n          this.state.textHeight !== height\n        ) {\n          this.setState({\n            textWidth: width,\n            textHeight: height,\n          });\n        }\n      }\n    }\n  }\n\n  componentDidMount() {\n    this.updateTextSize();\n  }\n\n  componentDidUpdate() {\n    this.updateTextSize();\n  }\n\n  getBgWidth() {\n    const { bgWidth } = this.props;\n    const { textWidth } = this.state;\n\n    if (bgWidth !== 'auto') {\n      return bgWidth;\n    } else if (textWidth !== undefined) {\n      return textWidth + PADDING;\n    } else {\n      return MIN_WIDTH;\n    }\n  }\n\n  getBgHeight() {\n    const { bgHeight } = this.props;\n    const { textHeight } = this.state;\n\n    if (bgHeight !== 'auto') {\n      return bgHeight;\n    } else if (textHeight !== undefined) {\n      return textHeight + PADDING;\n    } else {\n      return MIN_WIDTH;\n    }\n  }\n\n  renderSVG(moreProps) {\n    const { fontFamily, fontSize, fill, bgFill, bgOpacity } = this.props;\n\n    // console.log(moreProps)\n    const textMetaData = helper(\n      {\n        ...this.props,\n        bgWidth: this.getBgWidth(),\n        bgHeight: this.getBgHeight(),\n      },\n      moreProps\n    );\n\n    if (isDefined(textMetaData)) {\n      const { rect, text } = textMetaData;\n      return (\n        <g>\n          <rect\n            fill={bgFill}\n            fillOpacity={bgOpacity}\n            stroke={bgFill}\n            {...rect}\n          />\n          <text\n            ref={this.saveNode}\n            fontSize={fontSize}\n            fontFamily={fontFamily}\n            textAnchor=\"start\"\n            alignmentBaseline={'central'}\n            fill={fill}\n            x={text.x}\n            y={text.y}\n          >\n            {text.text}\n          </text>\n        </g>\n      );\n    }\n  }\n  render() {\n    const { text } = this.props;\n    if (text) {\n      return (\n        <GenericChartComponent\n          svgDraw={this.renderSVG}\n          drawOn={['mousemove']}\n        />\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nconst numberOrString = PropTypes.oneOfType([\n  PropTypes.number,\n  PropTypes.oneOf(['auto']),\n]);\n\nHoverTextNearMouse.propTypes = {\n  fontFamily: PropTypes.string.isRequired,\n  fontSize: PropTypes.number.isRequired,\n  fill: PropTypes.string.isRequired,\n  text: PropTypes.string.isRequired,\n  bgFill: PropTypes.string.isRequired,\n  bgOpacity: PropTypes.number.isRequired,\n  bgWidth: numberOrString.isRequired,\n  bgHeight: numberOrString.isRequired,\n  show: PropTypes.bool.isRequired,\n};\n\nHoverTextNearMouse.defaultProps = {\n  fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n  fontSize: 12,\n  fill: '#000000',\n  bgFill: '#FA9325',\n  bgOpacity: 0.5,\n};\n\nfunction helper(props, moreProps) {\n  const { show, bgWidth, bgHeight } = props;\n\n  const {\n    mouseXY,\n    chartConfig: { height, width },\n    show: mouseInsideCanvas,\n  } = moreProps;\n\n  if (show && mouseInsideCanvas) {\n    const [x, y] = mouseXY;\n\n    const cx = x < width / 2 ? x + PADDING : x - bgWidth - PADDING;\n\n    const cy = y < height / 2 ? y + PADDING : y - bgHeight - PADDING;\n\n    const rect = {\n      x: cx,\n      y: cy,\n      width: bgWidth,\n      height: bgHeight,\n    };\n\n    const text = {\n      text: props.text,\n      x: cx + PADDING / 2,\n      y: cy + bgHeight / 2,\n    };\n\n    return {\n      rect,\n      text,\n    };\n  }\n}\n\nexport default HoverTextNearMouse;\n"]}