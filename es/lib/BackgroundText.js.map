{"version":3,"sources":["../../../src/lib/BackgroundText.js"],"names":["React","PropTypes","PureComponent","hexToRGBA","isDefined","BackgroundText","context","chartCanvasType","getCanvasContexts","contexts","drawOnCanvas","bg","props","children","componentDidMount","x","y","fill","opacity","stroke","strokeOpacity","fontFamily","fontSize","textAnchor","ctx","getText","interval","clearRect","canvas","width","height","save","setTransform","translate","text","strokeStyle","font","fillStyle","textAlign","strokeText","fillText","restore","propTypes","number","isRequired","string","func","defaultProps","contextTypes"],"mappings":"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","file":"BackgroundText.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport PureComponent from './utils/PureComponent';\n\nimport { hexToRGBA, isDefined } from './utils';\n\nclass BackgroundText extends PureComponent {\n  componentDidMount() {\n    if (\n      this.context.chartCanvasType !== 'svg' &&\n      isDefined(this.context.getCanvasContexts)\n    ) {\n      const contexts = this.context.getCanvasContexts();\n      if (contexts)\n        BackgroundText.drawOnCanvas(\n          contexts.bg,\n          this.props,\n          this.context,\n          this.props.children\n        );\n    }\n  }\n  componentDidUpdate() {\n    this.componentDidMount();\n  }\n  render() {\n    const { chartCanvasType } = this.context;\n\n    if (chartCanvasType !== 'svg') return null;\n\n    const {\n      x,\n      y,\n      fill,\n      opacity,\n      stroke,\n      strokeOpacity,\n      fontFamily,\n      fontSize,\n      textAnchor,\n    } = this.props;\n    const props = {\n      x,\n      y,\n      fill,\n      opacity,\n      stroke,\n      strokeOpacity,\n      fontFamily,\n      fontSize,\n      textAnchor,\n    };\n    return <text {...props}>this.props.children(interval)</text>;\n  }\n}\n\nBackgroundText.drawOnCanvas = (ctx, props, { interval }, getText) => {\n  ctx.clearRect(-1, -1, ctx.canvas.width + 2, ctx.canvas.height + 2);\n  ctx.save();\n\n  ctx.setTransform(1, 0, 0, 1, 0, 0);\n  ctx.translate(0.5, 0.5);\n\n  const {\n    x,\n    y,\n    fill,\n    opacity,\n    stroke,\n    strokeOpacity,\n    fontFamily,\n    fontSize,\n    textAnchor,\n  } = props;\n\n  const text = getText(interval);\n\n  ctx.strokeStyle = hexToRGBA(stroke, strokeOpacity);\n\n  ctx.font = `${fontSize}px ${fontFamily}`;\n  ctx.fillStyle = hexToRGBA(fill, opacity);\n  ctx.textAlign = textAnchor === 'middle' ? 'center' : textAnchor;\n\n  if (stroke !== 'none') ctx.strokeText(text, x, y);\n  ctx.fillText(text, x, y);\n\n  ctx.restore();\n};\n\nBackgroundText.propTypes = {\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  fontFamily: PropTypes.string,\n  fontSize: PropTypes.number.isRequired,\n  fill: PropTypes.string,\n  stroke: PropTypes.string,\n  opacity: PropTypes.number,\n  strokeOpacity: PropTypes.number,\n  textAnchor: PropTypes.string,\n  children: PropTypes.func,\n};\n\nBackgroundText.defaultProps = {\n  opacity: 0.3,\n  fill: '#9E7523',\n  stroke: '#9E7523',\n  strokeOpacity: 1,\n  fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n  fontSize: 12,\n  textAnchor: 'middle',\n};\n\nBackgroundText.contextTypes = {\n  interval: PropTypes.string.isRequired,\n  getCanvasContexts: PropTypes.func,\n  chartCanvasType: PropTypes.string,\n};\n\nexport default BackgroundText;\n"]}