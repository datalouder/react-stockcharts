{"version":3,"sources":["../../../../src/lib/calculator/wma.js"],"names":["sum","slidingWindow","WMA","defaultOptions","options","calculator","data","windowSize","sourcePath","weight","waverage","accumulator","total","values","v","i","undefinedLength","x","arguments","length"],"mappings":";;AAAA,SAASA,GAAT,QAAoB,UAApB;;AAEA,SAASC,aAAT,QAA8B,UAA9B;AACA,SAASC,OAAOC,cAAhB,QAAsC,gCAAtC;;AAEA,eAAe,YAAY;AACzB,MAAIC,UAAUD,cAAd;;AAEA,WAASE,UAAT,CAAoBC,IAApB,EAA0B;AAAA,mBACWF,OADX;AAAA,QAChBG,UADgB,YAChBA,UADgB;AAAA,QACJC,UADI,YACJA,UADI;;;AAGxB,QAAMC,SAAUF,cAAcA,aAAa,CAA3B,CAAD,GAAkC,CAAjD;;AAEA,QAAMG,WAAWT,gBACdM,UADc,CACHA,UADG,EAEdC,UAFc,CAEHA,UAFG,EAGdG,WAHc,CAGF,kBAAU;AACrB,UAAMC,QAAQZ,IAAIa,MAAJ,EAAY,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAClC,eAAO,CAACA,IAAI,CAAL,IAAUD,CAAjB;AACD,OAFa,CAAd;AAGA,aAAOF,QAAQH,MAAf;AACD,KARc,CAAjB;;AAUA,WAAOC,SAASJ,IAAT,CAAP;AACD;AACDD,aAAWW,eAAX,GAA6B,YAAY;AAAA,oBAChBZ,OADgB;AAAA,QAC/BG,UAD+B,aAC/BA,UAD+B;;;AAGvC,WAAOA,aAAa,CAApB;AACD,GAJD;AAKAF,aAAWD,OAAX,GAAqB,UAAUa,CAAV,EAAa;AAChC,QAAI,CAACC,UAAUC,MAAf,EAAuB;AACrB,aAAOf,OAAP;AACD;AACDA,2BAAeD,cAAf,EAAkCc,CAAlC;AACA,WAAOZ,UAAP;AACD,GAND;;AAQA,SAAOA,UAAP;AACD","file":"wma.js","sourcesContent":["import { sum } from 'd3-array';\n\nimport { slidingWindow } from '../utils';\nimport { WMA as defaultOptions } from './defaultOptionsForComputation';\n\nexport default function () {\n  let options = defaultOptions;\n\n  function calculator(data) {\n    const { windowSize, sourcePath } = options;\n\n    const weight = (windowSize * (windowSize + 1)) / 2;\n\n    const waverage = slidingWindow()\n      .windowSize(windowSize)\n      .sourcePath(sourcePath)\n      .accumulator(values => {\n        const total = sum(values, (v, i) => {\n          return (i + 1) * v;\n        });\n        return total / weight;\n      });\n\n    return waverage(data);\n  }\n  calculator.undefinedLength = function () {\n    const { windowSize } = options;\n\n    return windowSize - 1;\n  };\n  calculator.options = function (x) {\n    if (!arguments.length) {\n      return options;\n    }\n    options = { ...defaultOptions, ...x };\n    return calculator;\n  };\n\n  return calculator;\n}\n"]}