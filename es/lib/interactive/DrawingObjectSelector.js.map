{"version":3,"sources":["../../../../src/lib/interactive/DrawingObjectSelector.js"],"names":["React","Component","PropTypes","isDefined","noop","mapObject","head","getMorePropsForChart","getSelected","GenericComponent","getMouseCanvas","DrawingObjectSelector","props","handleClick","bind","handleDoubleClick","getInteraction","moreProps","e","preventDefault","onDoubleClick","enabled","interactives","allSelected","length","selected","item","type","chartId","object","objects","morePropsForChart","onSelect","getInteractiveNodes","drawingObjectMap","interactiveNodes","key","each","valueArray","node","undefined","valuePresent","Array","isArray","getSelectionState","propTypes","func","isRequired","bool","defaultProps"],"mappings":"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","file":"DrawingObjectSelector.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { isDefined, noop, mapObject, head } from '../utils';\nimport { getMorePropsForChart, getSelected } from './utils';\n\nimport GenericComponent, { getMouseCanvas } from '../GenericComponent';\n\nclass DrawingObjectSelector extends Component {\n  constructor(props) {\n    super(props);\n    this.handleClick = this.handleClick.bind(this);\n    this.handleDoubleClick = this.handleDoubleClick.bind(this);\n    this.getInteraction = this.getInteraction.bind(this);\n  }\n  handleDoubleClick(moreProps, e) {\n    e.preventDefault();\n    const { onDoubleClick } = this.props;\n    const { enabled } = this.props;\n    if (!enabled) return;\n\n    const interactives = this.getInteraction(moreProps);\n    const allSelected = getSelected(interactives);\n\n    // console.log(selected, interactives)\n    if (allSelected.length > 0) {\n      const selected = head(allSelected);\n      const item = {\n        type: selected.type,\n        chartId: selected.chartId,\n        object: head(selected.objects),\n      };\n      const morePropsForChart = getMorePropsForChart(\n        moreProps,\n        selected.chartId\n      );\n      onDoubleClick(item, morePropsForChart);\n    }\n  }\n  handleClick(moreProps, e) {\n    e.preventDefault();\n    const { onSelect } = this.props;\n    const { enabled } = this.props;\n    if (!enabled) return;\n\n    const interactives = this.getInteraction(moreProps);\n\n    onSelect(interactives, moreProps);\n  }\n  getInteraction(moreProps) {\n    const { getInteractiveNodes, drawingObjectMap } = this.props;\n    const interactiveNodes = getInteractiveNodes();\n    const interactives = mapObject(interactiveNodes, each => {\n      const key = drawingObjectMap[each.type];\n\n      const valueArray = isDefined(key) ? each.node.props[key] : undefined;\n\n      const valuePresent =\n        isDefined(valueArray) &&\n        Array.isArray(valueArray) &&\n        valueArray.length > 0;\n      if (valuePresent) {\n        // console.log(\"Value present for \", each.type, each.chartId);\n        const morePropsForChart = getMorePropsForChart(moreProps, each.chartId);\n\n        const objects = each.node.getSelectionState(morePropsForChart);\n\n        return {\n          type: each.type,\n          chartId: each.chartId,\n          objects,\n        };\n      }\n      return {\n        type: each.type,\n        chartId: each.chartId,\n        objects: [],\n      };\n    });\n\n    return interactives;\n  }\n\n  render() {\n    return (\n      <GenericComponent\n        svgDraw={noop}\n        canvasToDraw={getMouseCanvas}\n        canvasDraw={noop}\n        onMouseDown={this.handleClick}\n        onDoubleClick={this.handleDoubleClick}\n        drawOn={['mousemove', 'pan', 'drag']}\n      />\n    );\n  }\n}\n\nDrawingObjectSelector.propTypes = {\n  getInteractiveNodes: PropTypes.func.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  onDoubleClick: PropTypes.func.isRequired,\n  drawingObjectMap: PropTypes.object.isRequired,\n  enabled: PropTypes.bool.isRequired,\n};\n\nDrawingObjectSelector.defaultProps = {\n  enabled: true,\n  onDoubleClick: noop,\n};\n\nexport default DrawingObjectSelector;\n"]}