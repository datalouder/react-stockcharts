{"version":3,"sources":["../../../../src/lib/interactive/GannFan.js"],"names":["React","Component","PropTypes","isDefined","isNotDefined","noop","terminate","saveNodeType","isHoverForInteractiveType","EachGannFan","MouseLocationIndicator","HoverTextNearMouse","GannFan","props","handleStart","bind","handleEnd","handleDrawFan","handleDragFan","handleDragFanComplete","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","fans","rest","newfans","map","each","idx","selected","onComplete","xyValue","current","startXY","mouseMoved","endXY","onStart","xyValyue","e","appearance","d","enabled","currentPositionRadius","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","hoverText","overrideIndex","tempChannel","eachAppearance","propTypes","bool","isRequired","func","onSelect","string","number","shape","stroke","strokeOpacity","fillOpacity","strokeWidth","edgeStroke","edgeFill","edgeStrokeWidth","r","fill","arrayOf","fontFamily","fontSize","fontFill","object","array","defaultProps","enable","bgHeight","bgWidth","text"],"mappings":"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","file":"GannFan.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { isDefined, isNotDefined, noop } from '../utils';\nimport { terminate, saveNodeType, isHoverForInteractiveType } from './utils';\nimport EachGannFan from './wrapper/EachGannFan';\nimport MouseLocationIndicator from './components/MouseLocationIndicator';\nimport HoverTextNearMouse from './components/HoverTextNearMouse';\n\nclass GannFan extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleStart = this.handleStart.bind(this);\n    this.handleEnd = this.handleEnd.bind(this);\n    this.handleDrawFan = this.handleDrawFan.bind(this);\n    this.handleDragFan = this.handleDragFan.bind(this);\n    this.handleDragFanComplete = this.handleDragFanComplete.bind(this);\n\n    this.terminate = terminate.bind(this);\n    this.saveNodeType = saveNodeType.bind(this);\n\n    this.getSelectionState = isHoverForInteractiveType('fans').bind(this);\n\n    this.nodes = [];\n    this.state = {};\n  }\n  handleDragFan(index, newXYValue) {\n    this.setState({\n      override: {\n        index,\n        ...newXYValue,\n      },\n    });\n  }\n  handleDragFanComplete(moreProps) {\n    const { override } = this.state;\n    const { fans } = this.props;\n\n    if (isDefined(override)) {\n      const { index, ...rest } = override;\n      const newfans = fans.map((each, idx) =>\n        idx === index ? { ...each, ...rest, selected: true } : each\n      );\n      this.setState(\n        {\n          override: null,\n        },\n        () => {\n          this.props.onComplete(newfans, moreProps);\n        }\n      );\n    }\n  }\n  handleDrawFan(xyValue) {\n    const { current } = this.state;\n\n    if (isDefined(current) && isDefined(current.startXY)) {\n      this.mouseMoved = true;\n\n      this.setState({\n        current: {\n          startXY: current.startXY,\n          endXY: xyValue,\n        },\n      });\n    }\n  }\n  handleStart(xyValue) {\n    const { current } = this.state;\n\n    if (isNotDefined(current) || isNotDefined(current.startXY)) {\n      this.mouseMoved = false;\n\n      this.setState(\n        {\n          current: {\n            startXY: xyValue,\n            endXY: null,\n          },\n        },\n        () => {\n          this.props.onStart();\n        }\n      );\n    }\n  }\n  handleEnd(xyValyue, moreProps, e) {\n    const { current } = this.state;\n    const { fans, appearance } = this.props;\n\n    if (this.mouseMoved && isDefined(current) && isDefined(current.startXY)) {\n      const newfans = [\n        ...fans.map(d => ({ ...d, selected: false })),\n        { ...current, selected: true, appearance },\n      ];\n      this.setState(\n        {\n          current: null,\n        },\n        () => {\n          this.props.onComplete(newfans, moreProps, e);\n        }\n      );\n    }\n  }\n  render() {\n    const { enabled, appearance } = this.props;\n    const { currentPositionRadius, currentPositionStroke } = this.props;\n    const { currentPositionOpacity, currentPositionStrokeWidth } = this.props;\n    const { hoverText, fans } = this.props;\n    const { current, override } = this.state;\n    const overrideIndex = isDefined(override) ? override.index : null;\n\n    const tempChannel =\n      isDefined(current) && isDefined(current.endXY) ? (\n        <EachGannFan\n          interactive={false}\n          {...current}\n          appearance={appearance}\n          hoverText={hoverText}\n        />\n      ) : null;\n\n    return (\n      <g>\n        {fans.map((each, idx) => {\n          const eachAppearance = isDefined(each.appearance)\n            ? { ...appearance, ...each.appearance }\n            : appearance;\n\n          return (\n            <EachGannFan\n              key={idx}\n              ref={this.saveNodeType(idx)}\n              index={idx}\n              selected={each.selected}\n              {...(idx === overrideIndex ? override : each)}\n              appearance={eachAppearance}\n              hoverText={hoverText}\n              onDrag={this.handleDragFan}\n              onDragComplete={this.handleDragFanComplete}\n            />\n          );\n        })}\n        {tempChannel}\n        <MouseLocationIndicator\n          enabled={enabled}\n          snap={false}\n          r={currentPositionRadius}\n          stroke={currentPositionStroke}\n          opacity={currentPositionOpacity}\n          strokeWidth={currentPositionStrokeWidth}\n          onMouseDown={this.handleStart}\n          onClick={this.handleEnd}\n          onMouseMove={this.handleDrawFan}\n        />\n      </g>\n    );\n  }\n}\n\nGannFan.propTypes = {\n  enabled: PropTypes.bool.isRequired,\n\n  onStart: PropTypes.func.isRequired,\n  onComplete: PropTypes.func.isRequired,\n  onSelect: PropTypes.func,\n\n  currentPositionStroke: PropTypes.string,\n  currentPositionStrokeWidth: PropTypes.number,\n  currentPositionOpacity: PropTypes.number,\n  currentPositionRadius: PropTypes.number,\n\n  appearance: PropTypes.shape({\n    stroke: PropTypes.string.isRequired,\n    strokeOpacity: PropTypes.number.isRequired,\n    fillOpacity: PropTypes.number.isRequired,\n    strokeWidth: PropTypes.number.isRequired,\n    edgeStroke: PropTypes.string.isRequired,\n    edgeFill: PropTypes.string.isRequired,\n    edgeStrokeWidth: PropTypes.number.isRequired,\n    r: PropTypes.number.isRequired,\n    fill: PropTypes.arrayOf(PropTypes.string).isRequired,\n    fontFamily: PropTypes.string.isRequired,\n    fontSize: PropTypes.number.isRequired,\n    fontFill: PropTypes.string.isRequired,\n  }).isRequired,\n  hoverText: PropTypes.object.isRequired,\n\n  fans: PropTypes.array.isRequired,\n};\n\nGannFan.defaultProps = {\n  appearance: {\n    stroke: '#000000',\n    fillOpacity: 0.2,\n    strokeOpacity: 1,\n    strokeWidth: 1,\n    edgeStroke: '#000000',\n    edgeFill: '#FFFFFF',\n    edgeStrokeWidth: 1,\n    r: 5,\n    fill: [\n      '#e41a1c',\n      '#377eb8',\n      '#4daf4a',\n      '#984ea3',\n      '#ff7f00',\n      '#ffff33',\n      '#a65628',\n      '#f781bf',\n    ],\n    fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n    fontSize: 12,\n    fontFill: '#000000',\n  },\n\n  onStart: noop,\n  onComplete: noop,\n  onSelect: noop,\n\n  currentPositionStroke: '#000000',\n  currentPositionOpacity: 1,\n  currentPositionStrokeWidth: 3,\n  currentPositionRadius: 4,\n\n  hoverText: {\n    ...HoverTextNearMouse.defaultProps,\n    enable: true,\n    bgHeight: 18,\n    bgWidth: 120,\n    text: 'Click to select object',\n  },\n  fans: [],\n};\n\nexport default GannFan;\n"]}