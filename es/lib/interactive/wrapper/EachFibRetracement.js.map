{"version":3,"sources":["../../../../../src/lib/interactive/wrapper/EachFibRetracement.js"],"names":["React","Component","PropTypes","head","last","noop","getXValue","saveNodeType","isHover","getNewXY","StraightLine","generateLine","ClickableCircle","HoverTextNearMouse","Text","EachFibRetracement","props","handleEdge1Drag","bind","handleEdge2Drag","handleLineNSResizeTop","handleLineNSResizeBottom","handleLineMove","handleLineDragStart","handleHover","nodes","state","hover","moreProps","hovering","setState","x1","y1","x2","y2","dragStart","index","onDrag","x1Value","y1Value","x2Value","y2Value","xScale","yScale","chartConfig","xAccessor","fullData","startPos","mouseXY","dx","dy","newX1Value","newY1Value","invert","newX2Value","newY2Value","interactive","yDisplayFormat","type","appearance","stroke","strokeWidth","strokeOpacity","fontFamily","fontSize","fontFill","edgeStroke","edgeFill","nsEdgeFill","edgeStrokeWidth","r","hoverText","selected","onDragComplete","lines","helper","hoverTextEnabled","enable","hoverTextSelected","selectedText","hoverTextUnselected","text","restHoverTextProps","lineType","dir","map","line","j","y","percent","toFixed","xyProvider","start","end","x","Math","min","firstOrLast","length","interactiveCursorClass","interactiveEdgeCursorClass","dragHandler","edge1DragHandler","edge2DragHandler","hoverHandler","onHover","onUnHover","retracements","each","propTypes","any","isRequired","number","func","string","bool","shape","object","defaultProps","d"],"mappings":"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","file":"EachFibRetracement.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { head, last, noop } from '../../utils';\nimport { getXValue } from '../../utils/ChartDataUtil';\nimport { saveNodeType, isHover } from '../utils';\n\nimport { getNewXY } from './EachTrendLine';\nimport StraightLine, { generateLine } from '../components/StraightLine';\nimport ClickableCircle from '../components/ClickableCircle';\nimport HoverTextNearMouse from '../components/HoverTextNearMouse';\nimport Text from '../components/Text';\n\nclass EachFibRetracement extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleEdge1Drag = this.handleEdge1Drag.bind(this);\n    this.handleEdge2Drag = this.handleEdge2Drag.bind(this);\n\n    this.handleLineNSResizeTop = this.handleLineNSResizeTop.bind(this);\n    this.handleLineNSResizeBottom = this.handleLineNSResizeBottom.bind(this);\n    this.handleLineMove = this.handleLineMove.bind(this);\n\n    this.handleLineDragStart = this.handleLineDragStart.bind(this);\n\n    this.handleHover = this.handleHover.bind(this);\n\n    this.isHover = isHover.bind(this);\n    this.saveNodeType = saveNodeType.bind(this);\n    this.nodes = {};\n\n    this.state = {\n      hover: false,\n    };\n  }\n  handleHover(moreProps) {\n    if (this.state.hover !== moreProps.hovering) {\n      this.setState({\n        hover: moreProps.hovering,\n      });\n    }\n  }\n  handleLineDragStart() {\n    const { x1, y1, x2, y2 } = this.props;\n\n    this.dragStart = {\n      x1,\n      y1,\n      x2,\n      y2,\n    };\n  }\n  handleLineMove(moreProps) {\n    const { index, onDrag } = this.props;\n\n    const {\n      x1: x1Value,\n      y1: y1Value,\n      x2: x2Value,\n      y2: y2Value,\n    } = this.dragStart;\n\n    const {\n      xScale,\n      chartConfig: { yScale },\n      xAccessor,\n      fullData,\n    } = moreProps;\n    const { startPos, mouseXY } = moreProps;\n\n    const x1 = xScale(x1Value);\n    const y1 = yScale(y1Value);\n    const x2 = xScale(x2Value);\n    const y2 = yScale(y2Value);\n\n    const dx = startPos[0] - mouseXY[0];\n    const dy = startPos[1] - mouseXY[1];\n\n    const newX1Value = getXValue(\n      xScale,\n      xAccessor,\n      [x1 - dx, y1 - dy],\n      fullData\n    );\n    const newY1Value = yScale.invert(y1 - dy);\n    const newX2Value = getXValue(\n      xScale,\n      xAccessor,\n      [x2 - dx, y2 - dy],\n      fullData\n    );\n    const newY2Value = yScale.invert(y2 - dy);\n\n    onDrag(index, {\n      x1: newX1Value,\n      y1: newY1Value,\n      x2: newX2Value,\n      y2: newY2Value,\n    });\n  }\n  handleLineNSResizeTop(moreProps) {\n    const { index, onDrag } = this.props;\n    const { x1, x2, y2 } = this.props;\n\n    const [, y1] = getNewXY(moreProps);\n\n    onDrag(index, {\n      x1,\n      y1,\n      x2,\n      y2,\n    });\n  }\n  handleLineNSResizeBottom(moreProps) {\n    const { index, onDrag } = this.props;\n    const { x1, y1, x2 } = this.props;\n\n    const [, y2] = getNewXY(moreProps);\n\n    onDrag(index, {\n      x1,\n      y1,\n      x2,\n      y2,\n    });\n  }\n  handleEdge1Drag(moreProps) {\n    const { index, onDrag } = this.props;\n    const { y1, x2, y2 } = this.props;\n\n    const [x1] = getNewXY(moreProps);\n\n    onDrag(index, {\n      x1,\n      y1,\n      x2,\n      y2,\n    });\n  }\n  handleEdge2Drag(moreProps) {\n    const { index, onDrag } = this.props;\n    const { x1, y1, y2 } = this.props;\n\n    const [x2] = getNewXY(moreProps);\n\n    onDrag(index, {\n      x1,\n      y1,\n      x2,\n      y2,\n    });\n  }\n  render() {\n    const { x1, x2, y1, y2 } = this.props;\n    const { interactive, yDisplayFormat, type, appearance } = this.props;\n    const { stroke, strokeWidth, strokeOpacity } = appearance;\n    const { fontFamily, fontSize, fontFill } = appearance;\n    const { edgeStroke, edgeFill, nsEdgeFill, edgeStrokeWidth, r } = appearance;\n    const { hoverText, selected } = this.props;\n    const { hover } = this.state;\n    const { onDragComplete } = this.props;\n    const lines = helper({ x1, x2, y1, y2 });\n\n    const {\n      enable: hoverTextEnabled,\n      selectedText: hoverTextSelected,\n      text: hoverTextUnselected,\n      ...restHoverTextProps\n    } = hoverText;\n\n    const lineType =\n      type === 'EXTEND' ? 'XLINE' : type === 'BOUND' ? 'LINE' : type;\n    const dir = head(lines).y1 > last(lines).y1 ? 3 : -1.3;\n\n    return (\n      <g>\n        {lines.map((line, j) => {\n          const text = `${yDisplayFormat(line.y)} (${line.percent.toFixed(\n            2\n          )}%)`;\n\n          const xyProvider = ({ xScale, chartConfig }) => {\n            const { yScale } = chartConfig;\n            const { x1, y1, x2 } = generateLine({\n              type: lineType,\n              start: [line.x1, line.y],\n              end: [line.x2, line.y],\n              xScale,\n              yScale,\n            });\n\n            const x = xScale(Math.min(x1, x2)) + 10;\n            const y = yScale(y1) + dir * 4;\n            return [x, y];\n          };\n\n          const firstOrLast = j === 0 || j === lines.length - 1;\n\n          const interactiveCursorClass = firstOrLast\n            ? 'react-stockcharts-ns-resize-cursor'\n            : 'react-stockcharts-move-cursor';\n\n          const interactiveEdgeCursorClass = firstOrLast\n            ? 'react-stockcharts-ns-resize-cursor'\n            : 'react-stockcharts-ew-resize-cursor';\n\n          const dragHandler =\n            j === 0\n              ? this.handleLineNSResizeTop\n              : j === lines.length - 1\n              ? this.handleLineNSResizeBottom\n              : this.handleLineMove;\n\n          const edge1DragHandler =\n            j === 0\n              ? this.handleLineNSResizeTop\n              : j === lines.length - 1\n              ? this.handleLineNSResizeBottom\n              : this.handleEdge1Drag;\n          const edge2DragHandler =\n            j === 0\n              ? this.handleLineNSResizeTop\n              : j === lines.length - 1\n              ? this.handleLineNSResizeBottom\n              : this.handleEdge2Drag;\n\n          const hoverHandler = interactive\n            ? { onHover: this.handleHover, onUnHover: this.handleHover }\n            : {};\n          return (\n            <g key={j}>\n              <StraightLine\n                ref={this.saveNodeType(`line_${j}`)}\n                selected={selected || hover}\n                {...hoverHandler}\n                type={lineType}\n                x1Value={line.x1}\n                y1Value={line.y}\n                x2Value={line.x2}\n                y2Value={line.y}\n                stroke={stroke}\n                strokeWidth={hover || selected ? strokeWidth + 1 : strokeWidth}\n                strokeOpacity={strokeOpacity}\n                interactiveCursorClass={interactiveCursorClass}\n                onDragStart={this.handleLineDragStart}\n                onDrag={dragHandler}\n                onDragComplete={onDragComplete}\n              />\n              <Text\n                selected={selected}\n                /* eslint-disable */\n                xyProvider={xyProvider}\n                /* eslint-enable */\n                fontFamily={fontFamily}\n                fontSize={fontSize}\n                fill={fontFill}\n              >\n                {text}\n              </Text>\n              <ClickableCircle\n                ref={this.saveNodeType('edge1')}\n                show={selected || hover}\n                cx={line.x1}\n                cy={line.y}\n                r={r}\n                fill={firstOrLast ? nsEdgeFill : edgeFill}\n                stroke={edgeStroke}\n                strokeWidth={edgeStrokeWidth}\n                interactiveCursorClass={interactiveEdgeCursorClass}\n                onDrag={edge1DragHandler}\n                onDragComplete={onDragComplete}\n              />\n              <ClickableCircle\n                ref={this.saveNodeType('edge2')}\n                show={selected || hover}\n                cx={line.x2}\n                cy={line.y}\n                r={r}\n                fill={firstOrLast ? nsEdgeFill : edgeFill}\n                stroke={edgeStroke}\n                strokeWidth={edgeStrokeWidth}\n                interactiveCursorClass={interactiveEdgeCursorClass}\n                onDrag={edge2DragHandler}\n                onDragComplete={onDragComplete}\n              />\n            </g>\n          );\n        })}\n        <HoverTextNearMouse\n          show={hoverTextEnabled && hover}\n          {...restHoverTextProps}\n          text={selected ? hoverTextSelected : hoverTextUnselected}\n        />\n      </g>\n    );\n  }\n}\n\nfunction helper({ x1, y1, x2, y2 }) {\n  const dy = y2 - y1;\n  const retracements = [100, 61.8, 50, 38.2, 23.6, 0].map(each => ({\n    percent: each,\n    x1,\n    x2,\n    y: y2 - (each / 100) * dy,\n  }));\n\n  return retracements;\n}\n\nEachFibRetracement.propTypes = {\n  x1: PropTypes.any.isRequired,\n  x2: PropTypes.any.isRequired,\n  y1: PropTypes.number.isRequired,\n  y2: PropTypes.number.isRequired,\n\n  yDisplayFormat: PropTypes.func.isRequired,\n  type: PropTypes.string.isRequired,\n  selected: PropTypes.bool.isRequired,\n\n  appearance: PropTypes.shape({\n    stroke: PropTypes.string.isRequired,\n    strokeWidth: PropTypes.number.isRequired,\n    strokeOpacity: PropTypes.number.isRequired,\n    fontFamily: PropTypes.string.isRequired,\n    fontSize: PropTypes.number.isRequired,\n    fontFill: PropTypes.string.isRequired,\n    edgeStroke: PropTypes.string.isRequired,\n    edgeFill: PropTypes.string.isRequired,\n    nsEdgeFill: PropTypes.string.isRequired,\n    edgeStrokeWidth: PropTypes.number.isRequired,\n    r: PropTypes.number.isRequired,\n  }).isRequired,\n\n  interactive: PropTypes.bool.isRequired,\n  hoverText: PropTypes.object.isRequired,\n\n  index: PropTypes.number,\n  onDrag: PropTypes.func.isRequired,\n  onDragComplete: PropTypes.func.isRequired,\n};\n\nEachFibRetracement.defaultProps = {\n  yDisplayFormat: d => d.toFixed(2),\n  interactive: true,\n\n  appearance: {\n    stroke: '#000000',\n    strokeWidth: 1,\n    strokeOpacity: 1,\n    fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n    fontSize: 10,\n    fontFill: '#000000',\n    edgeStroke: '#000000',\n    edgeFill: '#FFFFFF',\n    nsEdgeFill: '#000000',\n    edgeStrokeWidth: 1,\n    r: 5,\n  },\n  selected: false,\n\n  onDrag: noop,\n  onDragComplete: noop,\n\n  hoverText: {\n    enable: false,\n  },\n};\n\nexport default EachFibRetracement;\n"]}