{"version":3,"sources":["../../../../../src/lib/interactive/components/MouseLocationIndicator.js"],"names":["React","Component","PropTypes","GenericChartComponent","getMouseCanvas","isDefined","getClosestValue","noop","shallowEqual","functor","getXValue","MouseLocationIndicator","props","renderSVG","bind","drawOnCanvas","handleMousePosChange","handleMouseDown","handleClick","xy","mutableState","moreProps","e","pos","xValue","yValue","x","y","onMouseDown","onClick","xAccessor","plotData","mouseXY","currentItem","xScale","yScale","chartConfig","enabled","snap","shouldDisableSnap","snapTo","invert","mousXY","prevMouseXY","onMouseMove","ctx","r","stroke","strokeWidth","show","lineWidth","strokeStyle","moveTo","beginPath","arc","Math","PI","opacity","disablePan","handleContextMenu","propTypes","bool","isRequired","func","number","string","defaultProps"],"mappings":"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","file":"MouseLocationIndicator.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport GenericChartComponent from '../../GenericChartComponent';\nimport { getMouseCanvas } from '../../GenericComponent';\n\nimport {\n  isDefined,\n  getClosestValue,\n  noop,\n  shallowEqual,\n  functor,\n} from '../../utils';\nimport { getXValue } from '../../utils/ChartDataUtil';\n\nclass MouseLocationIndicator extends Component {\n  constructor(props) {\n    super(props);\n    this.renderSVG = this.renderSVG.bind(this);\n    this.drawOnCanvas = this.drawOnCanvas.bind(this);\n\n    this.handleMousePosChange = this.handleMousePosChange.bind(this);\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.xy = this.xy.bind(this);\n\n    this.mutableState = {};\n  }\n  handleMouseDown(moreProps, e) {\n    const pos = this.xy(moreProps, e);\n    if (isDefined(pos)) {\n      const { xValue, yValue, x, y } = pos;\n      this.mutableState = { x, y };\n      this.props.onMouseDown([xValue, yValue], moreProps, e);\n    }\n  }\n  handleClick(moreProps, e) {\n    const pos = this.xy(moreProps, e);\n    if (isDefined(pos)) {\n      const { xValue, yValue, x, y } = pos;\n      this.mutableState = { x, y };\n      this.props.onClick([xValue, yValue], moreProps, e);\n    }\n  }\n  xy(moreProps, e) {\n    const { xAccessor, plotData } = moreProps;\n    const {\n      mouseXY,\n      currentItem,\n      xScale,\n      chartConfig: { yScale },\n    } = moreProps;\n    const { enabled, snap, shouldDisableSnap, snapTo } = this.props;\n\n    if (enabled && isDefined(currentItem) && isDefined(e)) {\n      const xValue =\n        snap && !shouldDisableSnap(e)\n          ? xAccessor(currentItem)\n          : getXValue(xScale, xAccessor, mouseXY, plotData);\n      const yValue =\n        snap && !shouldDisableSnap(e)\n          ? getClosestValue(snapTo(currentItem), yScale.invert(mouseXY[1]))\n          : yScale.invert(mouseXY[1]);\n\n      const x = xScale(xValue);\n      const y = yScale(yValue);\n\n      return { xValue, yValue, x, y };\n    }\n  }\n  handleMousePosChange(moreProps, e) {\n    if (!shallowEqual(moreProps.mousXY, moreProps.prevMouseXY)) {\n      const pos = this.xy(moreProps, e);\n      if (isDefined(pos)) {\n        const { xValue, yValue, x, y } = pos;\n        this.mutableState = { x, y };\n        this.props.onMouseMove([xValue, yValue], e);\n      }\n    }\n  }\n  drawOnCanvas(ctx, moreProps) {\n    const { enabled, r, stroke, strokeWidth } = this.props;\n    const { x, y } = this.mutableState;\n    const { show } = moreProps;\n    // console.log(show)\n    if (enabled && show && isDefined(x)) {\n      ctx.lineWidth = strokeWidth;\n      ctx.strokeStyle = stroke;\n      ctx.moveTo(x, y);\n      ctx.beginPath();\n      ctx.arc(x, y, r, 0, 2 * Math.PI, false);\n      ctx.stroke();\n      // ctx.fill();\n    }\n  }\n  renderSVG(moreProps) {\n    const { enabled, r, stroke, strokeWidth, opacity } = this.props;\n    const { x, y } = this.mutableState;\n    const { show } = moreProps;\n\n    // console.log(\"HERE\")\n    // console.log(stroke, strokeWidth, opacity)\n\n    return enabled && show && isDefined(x) ? (\n      <circle\n        cx={x}\n        cy={y}\n        r={r}\n        stroke={stroke}\n        opacity={opacity}\n        fill=\"none\"\n        strokeWidth={strokeWidth}\n      />\n    ) : null;\n  }\n  render() {\n    const { enabled, disablePan } = this.props;\n    return (\n      <GenericChartComponent\n        onMouseDown={this.handleMouseDown}\n        onClick={this.handleClick}\n        onContextMenu={this.handleContextMenu}\n        onMouseMove={this.handleMousePosChange}\n        onPan={this.handleMousePosChange}\n        disablePan={enabled && disablePan}\n        svgDraw={this.renderSVG}\n        canvasDraw={this.drawOnCanvas}\n        canvasToDraw={getMouseCanvas}\n        drawOn={['mousemove', 'pan']}\n      />\n    );\n  }\n}\n\nMouseLocationIndicator.propTypes = {\n  enabled: PropTypes.bool.isRequired,\n  snap: PropTypes.bool.isRequired,\n  shouldDisableSnap: PropTypes.func.isRequired,\n  snapTo: PropTypes.func,\n\n  onMouseMove: PropTypes.func.isRequired,\n  onMouseDown: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  r: PropTypes.number.isRequired,\n  stroke: PropTypes.string.isRequired,\n  strokeWidth: PropTypes.number.isRequired,\n  opacity: PropTypes.number.isRequired,\n  disablePan: PropTypes.bool.isRequired,\n};\n\nMouseLocationIndicator.defaultProps = {\n  onMouseMove: noop,\n  onMouseDown: noop,\n  onClick: noop,\n  shouldDisableSnap: functor(false),\n  stroke: '#000000',\n  strokeWidth: 1,\n  opacity: 1,\n  disablePan: true,\n};\n\nexport default MouseLocationIndicator;\n"]}