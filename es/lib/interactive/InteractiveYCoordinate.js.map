{"version":3,"sources":["../../../../src/lib/interactive/InteractiveYCoordinate.js"],"names":["React","Component","PropTypes","format","isDefined","noop","strokeDashTypes","getValueFromOverride","terminate","saveNodeType","isHoverForInteractiveType","EachInteractiveYCoordinate","HoverTextNearMouse","InteractiveYCoordinate","props","handleDrag","bind","handleDragComplete","handleDelete","getSelectionState","nodes","state","index","yValue","setState","override","moreProps","yCoordinateList","newAlertList","map","each","idx","selected","draggedAlert","onDragComplete","xyValue","current","start","end","onDelete","id","propTypes","onChoosePosition","func","isRequired","onSelect","defaultPriceCoordinate","shape","bgFill","string","bgOpacity","number","stroke","strokeDasharray","oneOf","strokeOpacity","strokeWidth","textFill","fontFamily","fontWeight","fontStyle","fontSize","text","textBox","height","left","padding","right","closeIcon","width","edge","fill","fillOpacity","hoverText","object","array","enabled","bool","defaultProps","orient","at","arrowWidth","dx","rectWidth","rectHeight","displayFormat","enable","bgHeight","bgWidth","contextTypes","subscribe","unsubscribe","generateSubscriptionId","chartId","oneOfType"],"mappings":"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","file":"InteractiveYCoordinate.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { format } from 'd3-format';\nimport { isDefined, noop, strokeDashTypes } from '../utils';\n\nimport {\n  getValueFromOverride,\n  terminate,\n  saveNodeType,\n  isHoverForInteractiveType,\n} from './utils';\nimport EachInteractiveYCoordinate from './wrapper/EachInteractiveYCoordinate';\nimport HoverTextNearMouse from './components/HoverTextNearMouse';\n\nclass InteractiveYCoordinate extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleDrag = this.handleDrag.bind(this);\n    this.handleDragComplete = this.handleDragComplete.bind(this);\n    this.handleDelete = this.handleDelete.bind(this);\n    this.terminate = terminate.bind(this);\n\n    this.saveNodeType = saveNodeType.bind(this);\n    this.getSelectionState =\n      isHoverForInteractiveType('yCoordinateList').bind(this);\n\n    this.nodes = [];\n    this.state = {};\n  }\n  handleDrag(index, yValue) {\n    this.setState({\n      override: {\n        index,\n        yValue,\n      },\n    });\n  }\n  handleDragComplete(moreProps) {\n    const { override } = this.state;\n    if (isDefined(override)) {\n      const { yCoordinateList } = this.props;\n      const newAlertList = yCoordinateList.map((each, idx) => {\n        const selected = idx === override.index;\n        return selected\n          ? {\n              ...each,\n              yValue: override.yValue,\n              selected,\n            }\n          : {\n              ...each,\n              selected,\n            };\n      });\n      const draggedAlert = newAlertList[override.index];\n      this.setState(\n        {\n          override: null,\n        },\n        () => {\n          this.props.onDragComplete(newAlertList, moreProps, draggedAlert);\n        }\n      );\n    }\n  }\n  handleDrawLine(xyValue) {\n    const { current } = this.state;\n\n    if (isDefined(current) && isDefined(current.start)) {\n      this.setState({\n        current: {\n          start: current.start,\n          end: xyValue,\n        },\n      });\n    }\n  }\n  handleDelete(index, moreProps) {\n    const { onDelete, yCoordinateList } = this.props;\n    onDelete(yCoordinateList[index], moreProps);\n  }\n  render() {\n    const { yCoordinateList } = this.props;\n    const { override } = this.state;\n    return (\n      <g>\n        {yCoordinateList.map((each, idx) => {\n          const props = each;\n          return (\n            <EachInteractiveYCoordinate\n              key={each.id}\n              ref={this.saveNodeType(idx)}\n              index={idx}\n              {...props}\n              selected={each.selected}\n              yValue={getValueFromOverride(\n                override,\n                idx,\n                'yValue',\n                each.yValue\n              )}\n              onDelete={this.handleDelete}\n              onDrag={this.handleDrag}\n              onDragComplete={this.handleDragComplete}\n              edgeInteractiveCursor=\"react-stockcharts-move-cursor\"\n            />\n          );\n        })}\n      </g>\n    );\n  }\n}\n\nInteractiveYCoordinate.propTypes = {\n  onChoosePosition: PropTypes.func.isRequired,\n  onDragComplete: PropTypes.func.isRequired,\n  onSelect: PropTypes.func,\n  onDelete: PropTypes.func,\n\n  defaultPriceCoordinate: PropTypes.shape({\n    bgFill: PropTypes.string.isRequired,\n    bgOpacity: PropTypes.number.isRequired,\n\n    stroke: PropTypes.string.isRequired,\n    strokeDasharray: PropTypes.oneOf(strokeDashTypes).isRequired,\n    strokeOpacity: PropTypes.number.isRequired,\n    strokeWidth: PropTypes.number.isRequired,\n\n    textFill: PropTypes.string.isRequired,\n    fontFamily: PropTypes.string.isRequired,\n    fontWeight: PropTypes.string.isRequired,\n    fontStyle: PropTypes.string.isRequired,\n    fontSize: PropTypes.number.isRequired,\n    text: PropTypes.string.isRequired,\n\n    textBox: PropTypes.shape({\n      height: PropTypes.number.isRequired,\n      left: PropTypes.number.isRequired,\n      padding: PropTypes.shape({\n        left: PropTypes.number.isRequired,\n        right: PropTypes.number.isRequired,\n      }),\n      closeIcon: PropTypes.shape({\n        padding: PropTypes.shape({\n          left: PropTypes.number.isRequired,\n          right: PropTypes.number.isRequired,\n        }),\n        width: PropTypes.number.isRequired,\n      }),\n    }).isRequired,\n    edge: PropTypes.shape({\n      stroke: PropTypes.string.isRequired,\n      strokeOpacity: PropTypes.number.isRequired,\n      strokeWidth: PropTypes.number.isRequired,\n\n      fill: PropTypes.string.isRequired,\n      fillOpacity: PropTypes.number.isRequired,\n    }),\n  }).isRequired,\n\n  hoverText: PropTypes.object.isRequired,\n  yCoordinateList: PropTypes.array.isRequired,\n  enabled: PropTypes.bool.isRequired,\n};\n\nInteractiveYCoordinate.defaultProps = {\n  onChoosePosition: noop,\n  onDragComplete: noop,\n  onSelect: noop,\n  onDelete: noop,\n\n  defaultPriceCoordinate: {\n    bgFill: '#FFFFFF',\n    bgOpacity: 1,\n\n    stroke: '#6574CD',\n    strokeOpacity: 1,\n    strokeDasharray: 'ShortDash2',\n    strokeWidth: 1,\n\n    textFill: '#6574CD',\n    fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n    fontSize: 12,\n    fontStyle: 'normal',\n    fontWeight: 'normal',\n    text: 'Alert',\n    textBox: {\n      height: 24,\n      left: 20,\n      padding: { left: 10, right: 5 },\n      closeIcon: {\n        padding: { left: 5, right: 8 },\n        width: 8,\n      },\n    },\n    edge: {\n      stroke: '#6574CD',\n      strokeOpacity: 1,\n      strokeWidth: 1,\n\n      fill: '#FFFFFF',\n      fillOpacity: 1,\n      orient: 'right',\n      at: 'right',\n      arrowWidth: 10,\n      dx: 0,\n      rectWidth: 50,\n      rectHeight: 20,\n      displayFormat: format('.2f'),\n    },\n  },\n  hoverText: {\n    ...HoverTextNearMouse.defaultProps,\n    enable: true,\n    bgHeight: 18,\n    bgWidth: 175,\n    text: 'Click and drag the edge circles',\n  },\n  yCoordinateList: [],\n};\n\nInteractiveYCoordinate.contextTypes = {\n  subscribe: PropTypes.func.isRequired,\n  unsubscribe: PropTypes.func.isRequired,\n  generateSubscriptionId: PropTypes.func.isRequired,\n  chartId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\n};\n\nexport default InteractiveYCoordinate;\n"]}