{"version":3,"sources":["../../../../src/lib/axes/AxisTicks.js"],"names":["React","Component","PropTypes","hexToRGBA","isNotDefined","identity","tickTransform_svg_axisX","scale","tick","Math","round","tickTransform_svg_axisY","Tick","props","transform","tickStroke","tickStrokeOpacity","textAnchor","fontSize","fontFamily","x","y","x2","y2","dy","children","propTypes","arrayOf","Number","string","number","node","isRequired","drawOnCanvasStatic","ctx","result","tickTransform","canvas_dy","format","origin","beginPath","moveTo","lineTo","stroke","fillText","AxisTicks","helper","ticks","map","idx","orient","oneOf","innerTickSize","tickFormat","func","tickPadding","array","tickValues","defaultProps","tickArguments","domain","baseFormat","d","sign","tickSpacing","max","xScale","yScale","xAxis","strokeStyle","font","fillStyle","textAlign","forEach"],"mappings":"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","file":"AxisTicks.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { hexToRGBA, isNotDefined, identity } from '../utils';\n\nfunction tickTransform_svg_axisX(scale, tick) {\n  return [Math.round(scale(tick)), 0];\n}\n\nfunction tickTransform_svg_axisY(scale, tick) {\n  return [0, Math.round(scale(tick))];\n}\n\nclass Tick extends Component {\n  render() {\n    const {\n      transform,\n      tickStroke,\n      tickStrokeOpacity,\n      textAnchor,\n      fontSize,\n      fontFamily,\n    } = this.props;\n    const { x, y, x2, y2, dy } = this.props;\n    return (\n      <g\n        className=\"tick\"\n        transform={`translate(${transform[0]}, ${transform[1]})`}\n      >\n        <line\n          shapeRendering=\"crispEdges\"\n          opacity={tickStrokeOpacity}\n          stroke={tickStroke}\n          x2={x2}\n          y2={y2}\n        />\n        <text\n          dy={dy}\n          x={x}\n          y={y}\n          fill={tickStroke}\n          fontSize={fontSize}\n          fontFamily={fontFamily}\n          textAnchor={textAnchor}\n        >\n          {this.props.children}\n        </text>\n      </g>\n    );\n  }\n}\n\nTick.propTypes = {\n  transform: PropTypes.arrayOf(Number),\n  tickStroke: PropTypes.string,\n  tickStrokeOpacity: PropTypes.number,\n  textAnchor: PropTypes.string,\n  fontSize: PropTypes.number,\n  fontFamily: PropTypes.string,\n  x: PropTypes.number,\n  y: PropTypes.number,\n  x2: PropTypes.number,\n  y2: PropTypes.number,\n  dy: PropTypes.string,\n  children: PropTypes.node.isRequired,\n};\n\nTick.drawOnCanvasStatic = (tick, ctx, result) => {\n  const { scale, tickTransform, canvas_dy, x, y, x2, y2, format } = result;\n\n  const origin = tickTransform(scale, tick);\n\n  ctx.beginPath();\n\n  ctx.moveTo(origin[0], origin[1]);\n  ctx.lineTo(origin[0] + x2, origin[1] + y2);\n  ctx.stroke();\n\n  ctx.fillText(format(tick), origin[0] + x, origin[1] + y + canvas_dy);\n};\n\nclass AxisTicks extends Component {\n  render() {\n    const result = AxisTicks.helper(this.props, this.props.scale);\n    const {\n      ticks,\n      scale,\n      tickTransform,\n      tickStroke,\n      tickStrokeOpacity,\n      dy,\n      x,\n      y,\n      x2,\n      y2,\n      textAnchor,\n      fontSize,\n      fontFamily,\n      format,\n    } = result;\n\n    return (\n      <g>\n        {ticks.map((tick, idx) => {\n          return (\n            <Tick\n              key={idx}\n              transform={tickTransform(scale, tick)}\n              tickStroke={tickStroke}\n              tickStrokeOpacity={tickStrokeOpacity}\n              dy={dy}\n              x={x}\n              y={y}\n              x2={x2}\n              y2={y2}\n              textAnchor={textAnchor}\n              fontSize={fontSize}\n              fontFamily={fontFamily}\n            >\n              {format(tick)}\n            </Tick>\n          );\n        })}\n      </g>\n    );\n  }\n}\n\nAxisTicks.propTypes = {\n  orient: PropTypes.oneOf(['top', 'bottom', 'left', 'right']).isRequired,\n  innerTickSize: PropTypes.number,\n  tickFormat: PropTypes.func,\n  tickPadding: PropTypes.number,\n  ticks: PropTypes.array,\n  tickValues: PropTypes.array,\n  scale: PropTypes.func.isRequired,\n  tickStroke: PropTypes.string,\n  tickStrokeOpacity: PropTypes.number,\n};\n\nAxisTicks.defaultProps = {\n  innerTickSize: 5,\n  tickPadding: 6,\n  ticks: [10],\n  tickStroke: '#000',\n  tickStrokeOpacity: 1,\n};\n\nAxisTicks.helper = (props, scale) => {\n  const {\n    orient,\n    innerTickSize,\n    tickFormat,\n    tickPadding,\n    fontSize,\n    fontFamily,\n  } = props;\n  const {\n    ticks: tickArguments,\n    tickValues,\n    tickStroke,\n    tickStrokeOpacity,\n  } = props;\n\n  const ticks = isNotDefined(tickValues)\n    ? scale.ticks\n      ? scale.ticks(...tickArguments)\n      : scale.domain()\n    : tickValues;\n\n  const baseFormat = scale.tickFormat\n    ? scale.tickFormat(...tickArguments)\n    : identity;\n\n  const format = isNotDefined(tickFormat)\n    ? baseFormat\n    : d => (baseFormat(d) ? tickFormat(d) : '');\n\n  const sign = orient === 'top' || orient === 'left' ? -1 : 1;\n  const tickSpacing = Math.max(innerTickSize, 0) + tickPadding;\n\n  let tickTransform, x, y, x2, y2, dy, canvas_dy, textAnchor;\n\n  if (orient === 'bottom' || orient === 'top') {\n    tickTransform = tickTransform_svg_axisX;\n    x2 = 0;\n    y2 = sign * innerTickSize;\n    x = 0;\n    y = sign * tickSpacing;\n    dy = sign < 0 ? '0em' : '.71em';\n    canvas_dy = sign < 0 ? 0 : fontSize * 0.71;\n    textAnchor = 'middle';\n  } else {\n    tickTransform = tickTransform_svg_axisY;\n    x2 = sign * innerTickSize;\n    y2 = 0;\n    x = sign * tickSpacing;\n    y = 0;\n    dy = '.32em';\n    canvas_dy = fontSize * 0.32;\n    textAnchor = sign < 0 ? 'end' : 'start';\n  }\n  return {\n    ticks,\n    scale,\n    tickTransform,\n    tickStroke,\n    tickStrokeOpacity,\n    dy,\n    canvas_dy,\n    x,\n    y,\n    x2,\n    y2,\n    textAnchor,\n    fontSize,\n    fontFamily,\n    format,\n  };\n};\n\nAxisTicks.drawOnCanvasStatic = (props, ctx, xScale, yScale) => {\n  props = { ...AxisTicks.defaultProps, ...props };\n\n  const { orient } = props;\n  const xAxis = orient === 'bottom' || orient === 'top';\n\n  const result = AxisTicks.helper(props, xAxis ? xScale : yScale);\n\n  const { tickStroke, tickStrokeOpacity, textAnchor, fontSize, fontFamily } =\n    result;\n\n  ctx.strokeStyle = hexToRGBA(tickStroke, tickStrokeOpacity);\n\n  ctx.font = `${fontSize}px ${fontFamily}`;\n  ctx.fillStyle = tickStroke;\n  ctx.textAlign = textAnchor === 'middle' ? 'center' : textAnchor;\n  // ctx.textBaseline = 'middle';\n\n  result.ticks.forEach(tick => {\n    Tick.drawOnCanvasStatic(tick, ctx, result);\n  });\n};\n\nexport default AxisTicks;\n"]}