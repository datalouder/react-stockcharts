{"version":3,"sources":["../../../src/lib/EventCapture.js"],"names":["React","Component","PropTypes","select","event","d3Event","mouse","touches","isDefined","mousePosition","touchPosition","getTouchProps","d3Window","MOUSEMOVE","MOUSEUP","MOUSEENTER","MOUSELEAVE","TOUCHMOVE","TOUCHEND","noop","getCurrentCharts","EventCapture","props","handleEnter","bind","handleLeave","handleWheel","handleMouseMove","handleMouseDown","handlePanEnd","handlePan","handleTouchStart","handleTouchMove","handlePinchZoom","handlePinchZoomEnd","handleClick","handleRightClick","handleDrag","handleDragEnd","shouldPan","canPan","setCursorClass","saveNode","mouseInside","mouseInteraction","state","panInProgress","node","focus","on","addEventListener","passive","componentDidMount","win","removeEventListener","e","onMouseEnter","dragInProgress","onMouseLeave","zoom","onZoom","yZoom","Math","abs","deltaY","deltaX","mouseXY","preventDefault","zoomDir","panStart","panStartXScale","chartsToPan","lastNewPos","panHappened","dx","dy","dxdy","onPan","xScale","chartConfig","currentCharts","setState","panOrigin","queuePanEnd","panEndTimeout","clearTimeout","setTimeout","onMouseMove","mouseMove","newPos","onClick","onDoubleClick","dragHappened","clicked","stopPropagation","onContextMenu","onPanEnd","getBoundingClientRect","onDrag","startPos","dragStartPosition","onDragComplete","getAllPanConditions","initialPanEnabled","pan","reduce","returnObj","a","draggable","panEnabled","somethingSelected","button","onMouseDown","onDragStart","touchXY","length","touch1Pos","touch2Pos","pinchZoomStart","range","zoomEnabled","onPinchZoom","initialPinch","onPinchZoomEnd","cursorOverrideClass","height","width","disableInteraction","useCrossHairStyleCursor","className","interactionProps","onTouchStart","onTouchMove","opacity","propTypes","bool","isRequired","panSpeedMultiplier","number","array","func","xAccessor","children","defaultProps"],"mappings":"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","file":"EventCapture.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { select, event as d3Event, mouse, touches } from 'd3-selection';\n\nimport {\n  isDefined,\n  mousePosition,\n  touchPosition,\n  getTouchProps,\n  d3Window,\n  MOUSEMOVE,\n  MOUSEUP,\n  MOUSEENTER,\n  MOUSELEAVE,\n  TOUCHMOVE,\n  TOUCHEND,\n  noop,\n} from './utils';\nimport { getCurrentCharts } from './utils/ChartDataUtil';\n// import { clearTimeout, setTimeout } from \"timers\";\n\nclass EventCapture extends Component {\n  constructor(props) {\n    super(props);\n    this.handleEnter = this.handleEnter.bind(this);\n    this.handleLeave = this.handleLeave.bind(this);\n    this.handleWheel = this.handleWheel.bind(this);\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handlePanEnd = this.handlePanEnd.bind(this);\n    this.handlePan = this.handlePan.bind(this);\n    this.handleTouchStart = this.handleTouchStart.bind(this);\n    this.handleTouchMove = this.handleTouchMove.bind(this);\n    this.handlePinchZoom = this.handlePinchZoom.bind(this);\n    this.handlePinchZoomEnd = this.handlePinchZoomEnd.bind(this);\n\n    this.handleClick = this.handleClick.bind(this);\n\n    this.handleRightClick = this.handleRightClick.bind(this);\n    this.handleDrag = this.handleDrag.bind(this);\n    this.handleDragEnd = this.handleDragEnd.bind(this);\n\n    this.shouldPan = this.shouldPan.bind(this);\n    this.canPan = this.canPan.bind(this);\n\n    this.setCursorClass = this.setCursorClass.bind(this);\n    this.saveNode = this.saveNode.bind(this);\n\n    this.mouseInside = false;\n\n    this.mouseInteraction = true;\n    this.state = {\n      panInProgress: false,\n    };\n  }\n  saveNode(node) {\n    this.node = node;\n  }\n  componentWillMount() {\n    this.focus = this.props.focus;\n  }\n  componentDidMount() {\n    if (this.node) {\n      select(this.node)\n        .on(MOUSEENTER, this.handleEnter)\n        .on(MOUSELEAVE, this.handleLeave);\n\n      this.node.addEventListener('wheel', this.handleWheel, { passive: false });\n    }\n  }\n  componentDidUpdate() {\n    this.componentDidMount();\n  }\n  componentWillUnmount() {\n    if (this.node) {\n      select(this.node).on(MOUSEENTER, null).on(MOUSELEAVE, null);\n      const win = d3Window(this.node);\n      select(win).on(MOUSEMOVE, null);\n\n      this.node.removeEventListener('wheel', this.handleWheel, {\n        passive: false,\n      });\n    }\n  }\n  handleEnter() {\n    const e = d3Event;\n\n    const { onMouseEnter } = this.props;\n    this.mouseInside = true;\n    if (!this.state.panInProgress && !this.state.dragInProgress) {\n      const win = d3Window(this.node);\n      select(win).on(MOUSEMOVE, this.handleMouseMove);\n    }\n    onMouseEnter(e);\n  }\n  handleLeave(e) {\n    const { onMouseLeave } = this.props;\n    this.mouseInside = false;\n    if (!this.state.panInProgress && !this.state.dragInProgress) {\n      const win = d3Window(this.node);\n      select(win).on(MOUSEMOVE, null);\n    }\n    onMouseLeave(e);\n  }\n  handleWheel(e) {\n    const { zoom, onZoom } = this.props;\n    const { panInProgress } = this.state;\n\n    const yZoom =\n      Math.abs(e.deltaY) > Math.abs(e.deltaX) && Math.abs(e.deltaY) > 0;\n    // const xPan = Math.abs(e.deltaY) < Math.abs(e.deltaX) && Math.abs(e.deltaX) > 0;\n    const mouseXY = mousePosition(e);\n    e.preventDefault();\n\n    if (zoom && this.focus && yZoom && !panInProgress) {\n      const zoomDir = e.deltaY > 0 ? 1 : -1;\n\n      onZoom(zoomDir, mouseXY, e);\n    } else if (this.focus) {\n      if (this.shouldPan()) {\n        // console.log(\"Do pan now...\")\n        // pan already in progress\n        const { panStartXScale, chartsToPan } = this.state.panStart;\n        this.lastNewPos = mouseXY;\n        this.panHappened = true;\n\n        this.dx += e.deltaX;\n        this.dy += e.deltaY;\n        const dxdy = { dx: this.dx, dy: this.dy };\n\n        this.props.onPan(mouseXY, panStartXScale, dxdy, chartsToPan, e);\n      } else {\n        // console.log(\"Pan start...\")\n        // pan start\n\n        const { xScale, chartConfig } = this.props;\n        const currentCharts = getCurrentCharts(chartConfig, mouseXY);\n\n        this.dx = 0;\n        this.dy = 0;\n        this.setState({\n          panInProgress: true,\n          panStart: {\n            panStartXScale: xScale,\n            panOrigin: mouseXY,\n            chartsToPan: currentCharts,\n          },\n        });\n      }\n      this.queuePanEnd();\n    }\n  }\n  queuePanEnd() {\n    if (isDefined(this.panEndTimeout)) {\n      clearTimeout(this.panEndTimeout);\n    }\n    this.panEndTimeout = setTimeout(() => {\n      this.handlePanEnd();\n    }, 100);\n  }\n  handleMouseMove() {\n    const e = d3Event;\n\n    const { onMouseMove, mouseMove } = this.props;\n\n    if (this.mouseInteraction && mouseMove && !this.state.panInProgress) {\n      const newPos = mouse(this.node);\n\n      onMouseMove(newPos, 'mouse', e);\n    }\n  }\n  handleClick(e) {\n    const mouseXY = mousePosition(e);\n    const { onClick, onDoubleClick } = this.props;\n\n    if (!this.panHappened && !this.dragHappened) {\n      if (this.clicked) {\n        onDoubleClick(mouseXY, e);\n        this.clicked = false;\n      } else {\n        onClick(mouseXY, e);\n        this.clicked = true;\n        setTimeout(() => {\n          if (this.clicked) {\n            this.clicked = false;\n          }\n        }, 400);\n      }\n    }\n  }\n  handleRightClick(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    const { onContextMenu, onPanEnd } = this.props;\n\n    const mouseXY = mousePosition(e, this.node.getBoundingClientRect());\n\n    if (isDefined(this.state.panStart)) {\n      const { panStartXScale, panOrigin, chartsToPan } = this.state.panStart;\n      if (this.panHappened) {\n        onPanEnd(mouseXY, panStartXScale, panOrigin, chartsToPan, e);\n      }\n      const win = d3Window(this.node);\n      select(win).on(MOUSEMOVE, null).on(MOUSEUP, null);\n\n      this.setState({\n        panInProgress: false,\n        panStart: null,\n      });\n    }\n\n    onContextMenu(mouseXY, e);\n  }\n\n  handleDrag() {\n    const e = d3Event;\n    if (this.props.onDrag) {\n      this.dragHappened = true;\n      const mouseXY = mouse(this.node);\n      this.props.onDrag(\n        {\n          startPos: this.state.dragStartPosition,\n          mouseXY,\n        },\n        e\n      );\n    }\n  }\n  cancelDrag() {\n    const win = d3Window(this.node);\n    select(win)\n      .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n      .on(MOUSEUP, null);\n\n    this.setState({\n      dragInProgress: false,\n    });\n    this.mouseInteraction = true;\n  }\n  handleDragEnd() {\n    const e = d3Event;\n    const mouseXY = mouse(this.node);\n\n    const win = d3Window(this.node);\n    select(win)\n      .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n      .on(MOUSEUP, null);\n\n    if (this.dragHappened) {\n      this.props.onDragComplete(\n        {\n          mouseXY,\n        },\n        e\n      );\n    }\n\n    this.setState({\n      dragInProgress: false,\n    });\n    this.mouseInteraction = true;\n  }\n  canPan() {\n    const { getAllPanConditions } = this.props;\n    const { pan: initialPanEnabled } = this.props;\n\n    const { panEnabled, draggable: somethingSelected } =\n      getAllPanConditions().reduce(\n        (returnObj, a) => {\n          return {\n            draggable: returnObj.draggable || a.draggable,\n            panEnabled: returnObj.panEnabled && a.panEnabled,\n          };\n        },\n        {\n          draggable: false,\n          panEnabled: initialPanEnabled,\n        }\n      );\n\n    return {\n      panEnabled,\n      somethingSelected,\n    };\n  }\n  handleMouseDown(e) {\n    if (e.button !== 0) {\n      return;\n    }\n    const { xScale, chartConfig, onMouseDown } = this.props;\n\n    this.panHappened = false;\n    this.dragHappened = false;\n    this.focus = true;\n\n    if (!this.state.panInProgress && this.mouseInteraction) {\n      const mouseXY = mousePosition(e);\n      const currentCharts = getCurrentCharts(chartConfig, mouseXY);\n      const { panEnabled, somethingSelected } = this.canPan();\n      const pan = panEnabled && !somethingSelected;\n\n      if (pan) {\n        this.setState({\n          panInProgress: pan,\n          panStart: {\n            panStartXScale: xScale,\n            panOrigin: mouseXY,\n            chartsToPan: currentCharts,\n          },\n        });\n\n        const win = d3Window(this.node);\n        select(win)\n          .on(MOUSEMOVE, this.handlePan)\n          .on(MOUSEUP, this.handlePanEnd);\n      } else if (somethingSelected) {\n        this.setState({\n          panInProgress: false,\n          dragInProgress: true,\n          panStart: null,\n          dragStartPosition: mouseXY,\n        });\n        this.props.onDragStart({ startPos: mouseXY }, e);\n        // this.mouseInteraction = false;\n\n        const win = d3Window(this.node);\n        select(win)\n          .on(MOUSEMOVE, this.handleDrag)\n          .on(MOUSEUP, this.handleDragEnd);\n      }\n\n      onMouseDown(mouseXY, currentCharts, e);\n    }\n    e.preventDefault();\n  }\n  shouldPan() {\n    const { pan: panEnabled, onPan } = this.props;\n    return panEnabled && onPan && isDefined(this.state.panStart);\n  }\n  handlePan() {\n    const e = d3Event;\n\n    if (this.shouldPan()) {\n      this.panHappened = true;\n\n      const { panStartXScale, panOrigin, chartsToPan } = this.state.panStart;\n\n      const mouseXY = this.mouseInteraction\n        ? mouse(this.node)\n        : touches(this.node)[0];\n\n      this.lastNewPos = mouseXY;\n      const dx = mouseXY[0] - panOrigin[0];\n      const dy = mouseXY[1] - panOrigin[1];\n\n      this.dx = dx;\n      this.dy = dy;\n\n      this.props.onPan(mouseXY, panStartXScale, { dx, dy }, chartsToPan, e);\n    }\n  }\n  handlePanEnd() {\n    const e = d3Event;\n    const { pan: panEnabled, onPanEnd } = this.props;\n\n    if (isDefined(this.state.panStart)) {\n      const { panStartXScale, chartsToPan } = this.state.panStart;\n\n      const win = d3Window(this.node);\n      select(win)\n        .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n        .on(MOUSEUP, null)\n        .on(TOUCHMOVE, null)\n        .on(TOUCHEND, null);\n\n      if (\n        this.panHappened &&\n        // && !this.contextMenuClicked\n        panEnabled &&\n        onPanEnd\n      ) {\n        const { dx, dy } = this;\n\n        // console.log(dx, dy)\n        delete this.dx;\n        delete this.dy;\n        onPanEnd(this.lastNewPos, panStartXScale, { dx, dy }, chartsToPan, e);\n      }\n\n      this.setState({\n        panInProgress: false,\n        panStart: null,\n      });\n    }\n  }\n  handleTouchMove(e) {\n    const { onMouseMove } = this.props;\n    const touchXY = touchPosition(getTouchProps(e.touches[0]), e);\n    onMouseMove(touchXY, 'touch', e);\n  }\n  handleTouchStart(e) {\n    this.mouseInteraction = false;\n\n    const { pan: panEnabled, chartConfig, onMouseMove } = this.props;\n    const { xScale, onPanEnd } = this.props;\n\n    if (e.touches.length === 1) {\n      this.panHappened = false;\n      const touchXY = touchPosition(getTouchProps(e.touches[0]), e);\n      onMouseMove(touchXY, 'touch', e);\n\n      if (panEnabled) {\n        const currentCharts = getCurrentCharts(chartConfig, touchXY);\n\n        this.setState({\n          panInProgress: true,\n          panStart: {\n            panStartXScale: xScale,\n            panOrigin: touchXY,\n            chartsToPan: currentCharts,\n          },\n        });\n\n        const win = d3Window(this.node);\n        select(win)\n          .on(TOUCHMOVE, this.handlePan, false)\n          .on(TOUCHEND, this.handlePanEnd, false);\n      }\n    } else if (e.touches.length === 2) {\n      // pinch zoom begin\n      // do nothing pinch zoom is handled in handleTouchMove\n      const { panInProgress, panStart } = this.state;\n\n      if (panInProgress && panEnabled && onPanEnd) {\n        const { panStartXScale, panOrigin, chartsToPan } = panStart;\n\n        const win = d3Window(this.node);\n        select(win)\n          .on(MOUSEMOVE, this.mouseInside ? this.handleMouseMove : null)\n          .on(MOUSEUP, null)\n          .on(TOUCHMOVE, this.handlePinchZoom, false)\n          .on(TOUCHEND, this.handlePinchZoomEnd, false);\n\n        const touch1Pos = touchPosition(getTouchProps(e.touches[0]), e);\n        const touch2Pos = touchPosition(getTouchProps(e.touches[1]), e);\n\n        if (\n          this.panHappened &&\n          // && !this.contextMenuClicked\n          panEnabled &&\n          onPanEnd\n        ) {\n          onPanEnd(this.lastNewPos, panStartXScale, panOrigin, chartsToPan, e);\n        }\n\n        this.setState({\n          panInProgress: false,\n          pinchZoomStart: {\n            xScale,\n            touch1Pos,\n            touch2Pos,\n            range: xScale.range(),\n            chartsToPan,\n          },\n        });\n      }\n    }\n  }\n  handlePinchZoom() {\n    const e = d3Event;\n    const [touch1Pos, touch2Pos] = touches(this.node);\n    const { xScale, zoom: zoomEnabled, onPinchZoom } = this.props;\n\n    // eslint-disable-next-line no-unused-vars\n    const { chartsToPan, ...initialPinch } = this.state.pinchZoomStart;\n\n    if (zoomEnabled && onPinchZoom) {\n      onPinchZoom(\n        initialPinch,\n        {\n          touch1Pos,\n          touch2Pos,\n          xScale,\n        },\n        e\n      );\n    }\n  }\n  handlePinchZoomEnd() {\n    const e = d3Event;\n\n    const win = d3Window(this.node);\n    select(win).on(TOUCHMOVE, null).on(TOUCHEND, null);\n\n    const { zoom: zoomEnabled, onPinchZoomEnd } = this.props;\n\n    // eslint-disable-next-line no-unused-vars\n    const { chartsToPan, ...initialPinch } = this.state.pinchZoomStart;\n\n    if (zoomEnabled && onPinchZoomEnd) {\n      onPinchZoomEnd(initialPinch, e);\n    }\n\n    this.setState({\n      pinchZoomStart: null,\n    });\n  }\n  setCursorClass(cursorOverrideClass) {\n    if (cursorOverrideClass !== this.state.cursorOverrideClass) {\n      this.setState({\n        cursorOverrideClass,\n      });\n    }\n  }\n  render() {\n    const { height, width, disableInteraction, useCrossHairStyleCursor } =\n      this.props;\n    const className =\n      this.state.cursorOverrideClass != null\n        ? this.state.cursorOverrideClass\n        : !useCrossHairStyleCursor\n        ? ''\n        : this.state.panInProgress\n        ? 'react-stockcharts-grabbing-cursor'\n        : 'react-stockcharts-crosshair-cursor';\n\n    const interactionProps = disableInteraction || {\n      onMouseDown: this.handleMouseDown,\n      onClick: this.handleClick,\n      onContextMenu: this.handleRightClick,\n      onTouchStart: this.handleTouchStart,\n      onTouchMove: this.handleTouchMove,\n    };\n\n    return (\n      <rect\n        ref={this.saveNode}\n        className={className}\n        width={width}\n        height={height}\n        style={{ opacity: 0 }}\n        {...interactionProps}\n      />\n    );\n  }\n}\n\n// \t\t\t\tonMouseEnter={this.handleEnter}\n//\t\t\t\tonMouseLeave={this.handleLeave}\n\nEventCapture.propTypes = {\n  mouseMove: PropTypes.bool.isRequired,\n  zoom: PropTypes.bool.isRequired,\n  pan: PropTypes.bool.isRequired,\n  panSpeedMultiplier: PropTypes.number.isRequired,\n  focus: PropTypes.bool.isRequired,\n  useCrossHairStyleCursor: PropTypes.bool.isRequired,\n\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  chartConfig: PropTypes.array,\n  xScale: PropTypes.func.isRequired,\n  xAccessor: PropTypes.func.isRequired,\n  disableInteraction: PropTypes.bool.isRequired,\n\n  getAllPanConditions: PropTypes.func.isRequired,\n\n  onMouseMove: PropTypes.func,\n  onMouseEnter: PropTypes.func,\n  onMouseLeave: PropTypes.func,\n  onZoom: PropTypes.func,\n  onPinchZoom: PropTypes.func,\n  onPinchZoomEnd: PropTypes.func.isRequired,\n  onPan: PropTypes.func,\n  onPanEnd: PropTypes.func,\n  onDragStart: PropTypes.func,\n  onDrag: PropTypes.func,\n  onDragComplete: PropTypes.func,\n\n  onClick: PropTypes.func,\n  onDoubleClick: PropTypes.func,\n  onContextMenu: PropTypes.func,\n  onMouseDown: PropTypes.func,\n  children: PropTypes.node,\n};\n\nEventCapture.defaultProps = {\n  mouseMove: false,\n  zoom: false,\n  pan: false,\n  panSpeedMultiplier: 1,\n  focus: false,\n  onDragComplete: noop,\n  disableInteraction: false,\n};\n\nexport default EventCapture;\n"]}