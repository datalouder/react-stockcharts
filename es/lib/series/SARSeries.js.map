{"version":3,"sources":["../../../../src/lib/series/SARSeries.js"],"names":["React","Component","PropTypes","GenericChartComponent","getAxisCanvas","getMouseCanvas","isDefined","first","last","hexToRGBA","SARSeries","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","mouseXY","currentItem","yScale","chartConfig","yAccessor","y","currentY","ctx","fill","opacity","xAccessor","plotData","xScale","hovering","width","d","length","radius","Math","min","max","forEach","centerX","each","centerY","color","close","falling","rising","fillStyle","strokeStyle","beginPath","ellipse","PI","closePath","stroke","className","filter","map","idx","highlightOnHover","hoverProps","drawOn","canvasToDraw","onClick","onDoubleClick","onContextMenu","propTypes","string","object","isRequired","func","number","bool","defaultProps","e","console","log"],"mappings":"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","file":"SARSeries.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport GenericChartComponent from '../GenericChartComponent';\nimport { getAxisCanvas, getMouseCanvas } from '../GenericComponent';\n\nimport { isDefined, first, last, hexToRGBA } from '../utils';\n\nclass SARSeries extends Component {\n  constructor(props) {\n    super(props);\n    this.renderSVG = this.renderSVG.bind(this);\n    this.drawOnCanvas = this.drawOnCanvas.bind(this);\n    this.isHover = this.isHover.bind(this);\n  }\n  isHover(moreProps) {\n    const {\n      mouseXY,\n      currentItem,\n      chartConfig: { yScale },\n    } = moreProps;\n    const { yAccessor } = this.props;\n    const y = mouseXY[1];\n    const currentY = yScale(yAccessor(currentItem));\n    return y < currentY + 5 && y > currentY - 5;\n  }\n  drawOnCanvas(ctx, moreProps) {\n    const { yAccessor, fill, opacity } = this.props;\n    const {\n      xAccessor,\n      plotData,\n      xScale,\n      chartConfig: { yScale },\n      hovering,\n    } = moreProps;\n\n    const width =\n      xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)));\n\n    const d = ((width / plotData.length) * 0.5) / 2;\n    const radius = Math.min(2, Math.max(0.5, d)) + (hovering ? 2 : 0);\n\n    plotData.forEach(each => {\n      const centerX = xScale(xAccessor(each));\n      const centerY = yScale(yAccessor(each));\n      const color = yAccessor(each) > each.close ? fill.falling : fill.rising;\n\n      ctx.fillStyle = hexToRGBA(color, opacity);\n      ctx.strokeStyle = color;\n\n      ctx.beginPath();\n      ctx.ellipse(centerX, centerY, radius, radius, 0, 0, 2 * Math.PI);\n      ctx.closePath();\n      ctx.fill();\n      ctx.stroke();\n    });\n  }\n  renderSVG(moreProps) {\n    const { className, yAccessor } = this.props;\n    const {\n      xAccessor,\n      plotData,\n      xScale,\n      chartConfig: { yScale },\n    } = moreProps;\n    // console.log(moreProps);\n\n    return (\n      <g className={className}>\n        {plotData\n          .filter(each => isDefined(yAccessor(each)))\n          .map((each, idx) => {\n            return (\n              <circle\n                key={idx}\n                cx={xScale(xAccessor(each))}\n                cy={yScale(yAccessor(each))}\n                r={3}\n                fill=\"green\"\n              />\n            );\n          })}\n      </g>\n    );\n  }\n\n  render() {\n    const { highlightOnHover } = this.props;\n    const hoverProps = highlightOnHover\n      ? {\n          isHover: this.isHover,\n          drawOn: ['mousemove', 'pan'],\n          canvasToDraw: getMouseCanvas,\n        }\n      : {\n          drawOn: ['pan'],\n          canvasToDraw: getAxisCanvas,\n        };\n\n    return (\n      <GenericChartComponent\n        svgDraw={this.renderSVG}\n        canvasDraw={this.drawOnCanvas}\n        onClickWhenHover={this.props.onClick}\n        onDoubleClickWhenHover={this.props.onDoubleClick}\n        onContextMenuWhenHover={this.props.onContextMenu}\n        {...hoverProps}\n      />\n    );\n  }\n}\n\nSARSeries.propTypes = {\n  className: PropTypes.string,\n  fill: PropTypes.object.isRequired,\n  yAccessor: PropTypes.func.isRequired,\n  opacity: PropTypes.number.isRequired,\n  onClick: PropTypes.func,\n  onDoubleClick: PropTypes.func,\n  onContextMenu: PropTypes.func,\n  highlightOnHover: PropTypes.bool,\n};\n\nSARSeries.defaultProps = {\n  className: 'react-stockcharts-sar',\n  fill: {\n    falling: '#4682B4',\n    rising: '#15EC2E',\n  },\n  highlightOnHover: true,\n  opacity: 0.2,\n  onClick: function (e) {\n    console.log('Click', e);\n  },\n  onDoubleClick: function (e) {\n    console.log('Double Click', e);\n  },\n  onContextMenu: function (e) {\n    console.log('Right Click', e);\n  },\n};\n\nexport default SARSeries;\n"]}